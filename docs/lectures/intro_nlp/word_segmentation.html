
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Word Segmentation and Association &#8212; eKorpkit Tutorials</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/ekorpkit.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Vector Semantics and Representation" href="vectorization.html" />
    <link rel="prev" title="Tokenization" href="tokenization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FN4GFT8HP8"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-FN4GFT8HP8');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/ekorpkit.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">eKorpkit Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    eKonomic Research Python Toolkit
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/index.html">
   Getting started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/usage.html">
     Usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/features/index.html">
   Key features
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/easy_config.html">
     Easy Configuration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/no_boiler.html">
     No Boilerplate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/workflows.html">
     Workflows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/share.html">
     Sharable and Reproducible
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/plug.html">
     Pluggable Architece
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/config/index.html">
   Configuring ekorpkit
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/config/eKonf.html">
     Using eKonf class
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/datasets/index.html">
   Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/corpora/corpus.html">
     Build and Load Corpora
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/datasets/dataset.html">
     Build and Load Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/corpora/pipeline.html">
     Corpus task pipelines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/models/index.html">
   Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/models/automl/index.html">
     Auto ML
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/models/embeddings/index.html">
     Word Embeddings
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/embeddings/word2vec_basics.html">
       Word2Vec Basics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/embeddings/eval_vectors.html">
       Evaluate pretrained embeddings
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/models/ngram/index.html">
     N-Grams
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/ngram/ngram.html">
       N-Grams
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/ngram/ngram_for_lexicons.html">
       N-Gram model for ngram lexicon features
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/ngram/ngram_for_words.html">
       N-Gram model for unigram lexicon features
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/models/sentiment/index.html">
     Sentiment Analyers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/sentiment/lbsa_en.html">
       Lexicon-based Sentiment Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/sentiment/financial_phrasebank_lm.html">
       Evaluate LM with financial phrasebank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/sentiment/sentiment.html">
       LM Dictionary vs. finbert vs. T5
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/models/transformers/index.html">
     Transformers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/pipelines/index.html">
   Pipelines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/pipelines/pipeline.html">
     Instantiating pipeline
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/preprocessors/index.html">
   Preprocessors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/preprocessors/normalizer/index.html">
     Normalizers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/preprocessors/normalizer/normalizer.html">
       Normalizers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/preprocessors/segmenter/index.html">
     Segmenters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/preprocessors/segmenter/segmenter.html">
       Segmenters
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/preprocessors/tokenizer/index.html">
     Tokenizers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/preprocessors/tokenizer/mecab.html">
       Mecab Tokenizer
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/visualizers/index.html">
   Visualizers
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/visualizers/plot.html">
     Plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/workflow/index.html">
   Workflows
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../corpus/ekorpkot_corpus.html">
   The eKorpkit Corpus
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Use Cases
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../usecases/fomc/index.html">
   FOMC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/02_FOMC_numerical_data.html">
     Preparing Numerical Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/03_FOMC_corpus.html">
     Preparing Textual Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/04_FOMC_EDA_numericals.html">
     EDA on Numerical Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/05_FOMC_features.html">
     Visualizing Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/06_FOMC_AutoML.html">
     Checking Baseline with AutoML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/07_FOMC_sentiments.html">
     Predicting Sentiments of FOMC Corpus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/08_FOMC_EDA_sentiments.html">
     EDA on Sentiment Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/fomc/09_FOMC_AutoML_with_tones.html">
     Predicting the next decisions with tones
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../usecases/bok/index.html">
   Bank of Korea
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../usecases/edgar/index.html">
   EDGAR
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/edgar/predict_edgar.html">
     Prediciting Sentiments
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../usecases/esg/index.html">
   ESG
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/snorkel-polarity.html">
     Preparing polarity classification datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/rubrix.html">
     Improving classification datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/classifiers.html">
     Training Classifiers for ESG Ratings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/econ_news_corpus.html">
     Building
     <code class="docutils literal notranslate">
      <span class="pre">
       econ_news_kr
      </span>
     </code>
     corpus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/predict_news.html">
     Predicting ESG Categories and Polarities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/rubrix_classifiers.html">
     Preparing classifiers for active learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg/predict_for_learning.html">
     Preparing active learning data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../usecases/esg-en/index.html">
   ESG (English)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/esg-en/esg_corpus.html">
     Building
     <code class="docutils literal notranslate">
      <span class="pre">
       JOCo
      </span>
     </code>
     corpus
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../usecases/cointax/index.html">
   Taxation on Cryptocurrency
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../usecases/cointax/coin_dataset.html">
     Improving classification datasets
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Research
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../research/esg_topics/analyst.html">
   ESG Topic Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../research/esg_topics/rethink_esg.html">
   Rethinking ESG
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Introduction to NLP
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ekorpkit.html">
     Getting started with ekorpkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="research.html">
     Research Applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="topic.html">
     Topic Modeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="topic_models.html">
     Topic Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="topic_coherence.html">
     Topic Coherence Measures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiments.html">
     Sentiment Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tokenization.html">
     Tokenization
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Word Segmentation and Association
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vectorization.html">
     Vector Semantics and Representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="language_models.html">
     Language Models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../deep_nlp/index.html">
   Deep Learning for NLP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/ekorpkit.html">
     Getting started with ekorpkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/zeroshot.html">
     Zero Shot, Prompt, and Search Strategies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/bloom.html">
     What is BLOOM?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/bloom_apps.html">
     Bloom Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/transformers.html">
     Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/bert.html">
     BERT: Bidirectional Encoder Representations from Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/t5.html">
     T5: Text-To-Text Transfer Transformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/tokenization.html">
     Tokenization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/sentencepiece.html">
     SentencePiece Tokenizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/byt5.html">
     ByT5: Towards a token-free future with pre-trained byte-to-byte models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deep_nlp/lab1-corpus.html">
     Lab 1: Preparing Wikipedia Corpora
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../aiart/index.html">
   AI Art (Text-to-Image)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/project-themes.html">
     Project Themes - A Brave New World
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/dalle1.html">
     DALL·E 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/dalle2.html">
     DALL·E 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/imagen.html">
     Imagen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/dalle-mini.html">
     DALL·E Mini
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/disco.html">
     Disco Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/disco_batch.html">
     Disco Diffusion Batch Generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/stable-diffusion.html">
     Stable Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aiart/prompt-generator.html">
     Prompt Generator for Stable Diffusion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mlops/index.html">
   Machine Learning Systems Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ds/index.html">
   Data Science for Economics and Finance
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/index.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/cite.html">
   Citation
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/entelecheia/ekorpkit-book/main?urlpath=tree/ekorpkit-book/docs/lectures/intro_nlp/word_segmentation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/entelecheia/ekorpkit-book/blob/main/ekorpkit-book/docs/lectures/intro_nlp/word_segmentation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/entelecheia/ekorpkit-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/entelecheia/ekorpkit-book/issues/new?title=Issue%20on%20page%20%2Fdocs/lectures/intro_nlp/word_segmentation.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/docs/lectures/intro_nlp/word_segmentation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#word-segmentation">
   Word Segmentation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-should-we-segment-words">
   Why should we segment words?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-segment-variants">
   Generating segment variants
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#naive-recursive-algorithm">
     Naive Recursive Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamic-programming">
     Dynamic Programming
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#triangular-matrix">
     Triangular Matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maximum-matching-algorithm">
     Maximum Matching Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unknown-words">
     Unknown Words
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-of-compositions">
   Evaluation of Compositions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uncertainty-of-word-boundaries">
   Uncertainty of word boundaries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessor-variety">
     Accessor Variety
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#branching-entropy">
     Branching Entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#word-segmentation-in-practice">
   Word Segmentation in Practice
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#word-segmentation-for-korean">
     Word Segmentation for Korean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-with-news-article-samples">
     Working with news article samples
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Word Segmentation and Association</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#word-segmentation">
   Word Segmentation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-should-we-segment-words">
   Why should we segment words?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-segment-variants">
   Generating segment variants
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#naive-recursive-algorithm">
     Naive Recursive Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamic-programming">
     Dynamic Programming
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#triangular-matrix">
     Triangular Matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maximum-matching-algorithm">
     Maximum Matching Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unknown-words">
     Unknown Words
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-of-compositions">
   Evaluation of Compositions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uncertainty-of-word-boundaries">
   Uncertainty of word boundaries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessor-variety">
     Accessor Variety
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#branching-entropy">
     Branching Entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#word-segmentation-in-practice">
   Word Segmentation in Practice
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#word-segmentation-for-korean">
     Word Segmentation for Korean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-with-news-article-samples">
     Working with news article samples
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="word-segmentation-and-association">
<h1>Word Segmentation and Association<a class="headerlink" href="#word-segmentation-and-association" title="Permalink to this headline">#</a></h1>
<p><img alt="" src="../../../_images/entelecheia_associaltion_vs_segmentation.png" /></p>
<section id="word-segmentation">
<h2>Word Segmentation<a class="headerlink" href="#word-segmentation" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Word segmentation</strong> is the task of splitting a string of characters into words.</p></li>
<li><p>Word segmentation is important for a machine to understand the meaning of a sentence.</p></li>
<li><p>In English, we can split a string of characters into words by spaces.</p></li>
<li><p>However, in languages like Chinese and Janpanese, there is no space between words.</p></li>
<li><p>Even in English, there are some cases where no space is used between words.</p></li>
<li><p>Humans can easily segment a string of characters into words, even though there is no space between words.</p></li>
<li><p>For example, we can easily segment the string of characters <code class="docutils literal notranslate"><span class="pre">Ilikechocolate</span></code> into words <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">like</span> <span class="pre">chocolate</span></code>.</p></li>
</ul>
</section>
<section id="why-should-we-segment-words">
<h2>Why should we segment words?<a class="headerlink" href="#why-should-we-segment-words" title="Permalink to this headline">#</a></h2>
<p>There are many applications that require word segmentation, even in English.</p>
<ul class="simple">
<li><p>Normalizing English compound nouns that are variably written for search engines.</p>
<ul>
<li><p>For example, <code class="docutils literal notranslate"><span class="pre">ice</span> <span class="pre">cream</span></code> and <code class="docutils literal notranslate"><span class="pre">ice-cream</span></code> should be segmented into <code class="docutils literal notranslate"><span class="pre">icecream</span></code>.</p></li>
</ul>
</li>
<li><p>Word segmentation for compounds: Both orginal words and split words should be in the dictionary.</p></li>
<li><p>Typing errors may be corrected by word segmentation.</p></li>
<li><p>Conversion errors: During conversion, some spaces may be lost.</p></li>
<li><p>OCR errors: OCRed text may contain errors.</p></li>
<li><p>Keyword extraction from URL addresses, domain names, table column description or programming variables that are written without spaces.</p></li>
<li><p>For password analysis, the extraction of terms from passwords can be required.</p></li>
<li><p>Automatic CamelCasing of programming variables.</p></li>
<li><p>Speech recognition: Speech recognition systems may not properly recognize spaces between words.</p></li>
</ul>
</section>
<section id="generating-segment-variants">
<h2>Generating segment variants<a class="headerlink" href="#generating-segment-variants" title="Permalink to this headline">#</a></h2>
<p>We can generate all possible segment variants of a string of characters. Each distinct segment variant is called a <strong>composition</strong>.</p>
<ul class="simple">
<li><p>En a string of length <span class="math notranslate nohighlight">\(n\)</span>, there are <span class="math notranslate nohighlight">\(n-1\)</span> possible positions to split the string.</p></li>
<li><p>Each of the <span class="math notranslate nohighlight">\(n-1\)</span> positions can be used as word boundary.</p></li>
<li><p>Therefore, there are <span class="math notranslate nohighlight">\(2^{n-1}\)</span> possible compositions.</p></li>
</ul>
<p>The compositions have to be evaluated to find the best segmentation.</p>
<ul class="simple">
<li><p>The best segmentation is the one that has the highest probability.</p></li>
</ul>
<section id="naive-recursive-algorithm">
<h3>Naive Recursive Algorithm<a class="headerlink" href="#naive-recursive-algorithm" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The naive recursive algorithm is to generate all possible compositions and evaluate them.</p></li>
<li><p>The time complexity of the naive recursive algorithm is <span class="math notranslate nohighlight">\(O(2^n)\)</span>.</p></li>
<li><p>The naive recursive algorithm is not efficient for long strings.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="k">def</span> <span class="nf">segment_naive</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[[</span><span class="n">string</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">string</span><span class="p">[:</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">rest</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">rest</span> <span class="ow">in</span> <span class="n">segment_naive</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
        <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">segment_naive</span><span class="p">(</span><span class="s2">&quot;isit&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;isit&#39;],
 [&#39;i&#39;, &#39;sit&#39;],
 [&#39;i&#39;, &#39;s&#39;, &#39;it&#39;],
 [&#39;i&#39;, &#39;s&#39;, &#39;i&#39;, &#39;t&#39;],
 [&#39;i&#39;, &#39;si&#39;, &#39;t&#39;],
 [&#39;is&#39;, &#39;it&#39;],
 [&#39;is&#39;, &#39;i&#39;, &#39;t&#39;],
 [&#39;isi&#39;, &#39;t&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">segment_naive</span><span class="p">(</span><span class="s2">&quot;가방에&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;가방에&#39;], [&#39;가&#39;, &#39;방에&#39;], [&#39;가&#39;, &#39;방&#39;, &#39;에&#39;], [&#39;가방&#39;, &#39;에&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;thisislongtext&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_naive</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14 8192
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;아버지가방에들어가신다&quot;</span> <span class="c1"># Father goes into the bag or Father enters the room</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_naive</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11 1024
</pre></div>
</div>
</div>
</div>
</section>
<section id="dynamic-programming">
<h3>Dynamic Programming<a class="headerlink" href="#dynamic-programming" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Dynamic programming is a technique to solve a problem by breaking it into subproblems and storing the results of subproblems to avoid computing the same results again.</p></li>
<li><p>The time complexity of dynamic programming is <span class="math notranslate nohighlight">\(O(n)\)</span>.</p></li>
<li><p>For long strings, dynamic programming is much more efficient than the naive recursive algorithm.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">segment</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">first</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">string</span><span class="p">[:</span><span class="n">end</span><span class="p">],</span> <span class="n">string</span><span class="p">[</span><span class="n">end</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">first</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">first</span><span class="p">]</span> <span class="o">+</span> <span class="n">segment</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">string</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="triangular-matrix">
<h3>Triangular Matrix<a class="headerlink" href="#triangular-matrix" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The dynamic programming algorithm can be implemented using a triangular matrix.</p></li>
<li><p>The tryangular matrix algorithm uses nested loops and a circular buffer to store the results of subproblems.</p></li>
<li><p>A triangular matrix of parts with increasing length is generated and organized in a circular buffer.</p></li>
<li><p>This allows a constant amount of memory to be used for the algorithm.</p></li>
</ul>
</section>
<section id="maximum-matching-algorithm">
<h3>Maximum Matching Algorithm<a class="headerlink" href="#maximum-matching-algorithm" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>If we have all known words in a dictionary, we can use the maximum matching algorithm to segment a sentence.</p></li>
<li><p>The maximum matching algorithm is a greedy algorithm that finds the longest matching word from the dictionary.</p></li>
<li><p>The algorithm is as follows:</p>
<ol class="simple">
<li><p>Find the longest matching word from the dictionary.</p></li>
<li><p>If the word is found, add the word to the result and remove the word from the input.</p></li>
<li><p>If the word is not found, add the first character to the result and remove the first character from the input.</p></li>
<li><p>Repeat 1-3 until the input is empty.</p></li>
</ol>
</li>
</ul>
</section>
<section id="unknown-words">
<h3>Unknown Words<a class="headerlink" href="#unknown-words" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>We can not rely on the dictionary to segment all words.</p></li>
<li><p>There are uncommon words, new words, misspelled words, foreign words, proper nouns, slang words, etc.</p></li>
<li><p>Even in these cases, we want to segment the words into meaningful parts.</p></li>
<li><p>Therefore, we have to estimate the probability of any possible segmentation.</p></li>
</ul>
</section>
</section>
<section id="evaluation-of-compositions">
<h2>Evaluation of Compositions<a class="headerlink" href="#evaluation-of-compositions" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>Generally, we can evaluate a composition by calculating the probability of the composition.</p></li>
<li><p>Word probabilities can be estimated from a corpus:</p>
<div class="math notranslate nohighlight">
\[
    P(w_i) = \frac{c(w_i)}{N}
    \]</div>
<p>where <span class="math notranslate nohighlight">\(c(w_i)\)</span> is the count of word <span class="math notranslate nohighlight">\(w_i\)</span> and <span class="math notranslate nohighlight">\(N\)</span> is the total number of words in the corpus.</p>
</li>
<li><p>However, for unkonwn words, we have to use other criteria to evaluate the composition.</p></li>
<li><p>At word boundary, the uncertainty of the segmentation increases.</p></li>
<li><p>By measuring the uncertainty, we can evaluate the composition.</p></li>
</ul>
</section>
<section id="uncertainty-of-word-boundaries">
<h2>Uncertainty of word boundaries<a class="headerlink" href="#uncertainty-of-word-boundaries" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>The uncertainty of word boundaries can be measured by the entropy of the word boundary.</p></li>
<li><p><span id="id1">[<a class="reference internal" href="../../about/index.html#id20" title="Zellig S Harris. From phoneme to morpheme. In Papers in structural and transformational linguistics, pages 32–67. Springer, 1970. URL: http://www.eecs.qmul.ac.uk/~mpurver/papers/griffiths-et-al15qitl.pdf.">Harris, 1970</a>]</span> said that if the uncertainty of successive tokens increases, the location is a word boundary.</p></li>
<li><p><span id="id2">[<a class="reference internal" href="../../about/index.html#id18" title="Haodi Feng, Kang Chen, Xiaotie Deng, and Weimin Zheng. Accessor variety criteria for chinese word extraction. Computational linguistics, 30(1):75–93, 2004. URL: https://aclanthology.org/J04-1004.pdf.">Feng <em>et al.</em>, 2004</a>]</span> proposed a statistical criterion called accessor variety (AV) to measure how likely a sub-sequence is a word, and then to find the best segmentation pattern that maximizes a target function of accessor variety and the length of the sub-sequence as variants.</p></li>
<li><p><span id="id3">[<a class="reference internal" href="../../about/index.html#id19" title="Zhihui Jin and Kumiko Tanaka-Ishii. Unsupervised segmentation of Chinese text by use of branching entropy. In Proceedings of the COLING/ACL 2006 Main Conference Poster Sessions, 428–435. Sydney, Australia, July 2006. Association for Computational Linguistics. URL: https://aclanthology.org/P06-2056.">Jin and Tanaka-Ishii, 2006</a>]</span> proposed branching entropy as another criterion for unsupervised segmentation.</p></li>
<li><p>Both criteria share a similar assumption as in the fundamental work by Harris, 1970, that the uncertainty of successive tokens increases at word boundaries.</p></li>
<li><p>The latter is the countinous version of the former.</p></li>
</ul>
<p><img alt="" src="../../../_images/branching_entropy_uncertainty.png" /></p>
<section id="accessor-variety">
<h3>Accessor Variety<a class="headerlink" href="#accessor-variety" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>The accessor variety (AV) defines that the uncertainty of a sub-sequence is the number of different words that can be formed by adding a sub-sequence to the sub-sequence.</p></li>
<li><p>For the forward accessor variety, it is the number of different words that can be formed by adding a sub-sequence to the right side of the sub-sequence.</p></li>
<li><p>For the following sub-sequence, the forward accessor variety of <code class="docutils literal notranslate"><span class="pre">hope</span></code> is 2, because <code class="docutils literal notranslate"><span class="pre">hope</span></code> can be followed by <code class="docutils literal notranslate"><span class="pre">less</span></code> or <code class="docutils literal notranslate"><span class="pre">fully</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;hopeful&quot;</span><span class="p">:</span> <span class="mi">100</span>
<span class="s2">&quot;hopeless&quot;</span><span class="p">:</span> <span class="mi">80</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p>The backward accessor variety is the number of different words that can be formed by adding a sub-sequence to the left side of the sub-sequence.</p></li>
<li><p>For example, the backward accessor variety of <code class="docutils literal notranslate"><span class="pre">less</span></code> is 3, because <code class="docutils literal notranslate"><span class="pre">hopeless</span></code>, <code class="docutils literal notranslate"><span class="pre">useless</span></code>, and <code class="docutils literal notranslate"><span class="pre">pointless</span></code> can be formed by adding <code class="docutils literal notranslate"><span class="pre">less</span></code> to the left side of <code class="docutils literal notranslate"><span class="pre">less</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;hopeless&quot;</span><span class="p">:</span> <span class="mi">80</span>
<span class="s2">&quot;unless&quot;</span><span class="p">:</span> <span class="mi">160</span>
<span class="s2">&quot;pointless&quot;</span><span class="p">:</span> <span class="mi">70</span>
</pre></div>
</div>
</li>
<li><p>Depending on the language, the forward accessor variety or the backward accessor variety may be more suitable for segmentation.</p></li>
<li><p>Threshold values can be used to determine the word boundaries.</p></li>
<li><p>The threshold values can be determined by the corpus.</p></li>
</ul>
</section>
<section id="branching-entropy">
<h3>Branching Entropy<a class="headerlink" href="#branching-entropy" title="Permalink to this headline">#</a></h3>
<p><strong>Assumption 1</strong>: The uncertainty of successive tokens increases at word boundaries.</p>
<ul>
<li><p>Given a set of elements <span class="math notranslate nohighlight">\(X\)</span> and a set of n-gram sequences <span class="math notranslate nohighlight">\(X_n\)</span>, the conditional entropy of an element occuring after an n-gram sequence <span class="math notranslate nohighlight">\(X_n\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[
    H(X|X_n) = -\sum_{x_n \in X_n} P(x_n) \sum_{x \in X} P(x|x_n) \log P(x|x_n)
    \]</div>
<p>where <span class="math notranslate nohighlight">\(P(x) = P(X=x)\)</span>, <span class="math notranslate nohighlight">\(P(x|x_n) = P(X=x|X_n=x_n)\)</span>, and <span class="math notranslate nohighlight">\(P(X=x)\)</span> indicates the probability of an element <span class="math notranslate nohighlight">\(x\)</span> occuring in <span class="math notranslate nohighlight">\(X\)</span>.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(H(X|X_n)\)</span> decreases as <span class="math notranslate nohighlight">\(n\)</span> increases, meaning that <span class="math notranslate nohighlight">\(X\)</span> will become more predictable as <span class="math notranslate nohighlight">\(X_n\)</span> becomes longer.</p></li>
<li><p>The latter half of the equation, the entropy of <span class="math notranslate nohighlight">\(X\)</span> given <span class="math notranslate nohighlight">\(X_n\)</span>, indicates the average information of branching out from a specific n-gram sequence <span class="math notranslate nohighlight">\(X_n\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    H(X|X_n=x_n) = -\sum_{x \in X} P(x|x_n) \log P(x|x_n)
    \]</div>
</li>
<li><p>This local entropy is the branching entropy of <span class="math notranslate nohighlight">\(X\)</span> given <span class="math notranslate nohighlight">\(X_n\)</span>, and denoted as <span class="math notranslate nohighlight">\(h(x_n)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    h(x_n) = -\sum_{x \in X} P(x|x_n) \log P(x|x_n)
    \]</div>
</li>
</ul>
<p><strong>Assumption 2</strong>: If the entropy of successive tokens is high or increasing, the location is a word boundary.</p>
<ul>
<li><p>Generally, as the length of the n-gram sequence increases, the entropy of the n-gram sequence decreases.</p>
<div class="math notranslate nohighlight">
\[
    h(x_n) \geq h(x_{n-1})
    \]</div>
</li>
<li><p>If <span class="math notranslate nohighlight">\(x_n\)</span> is the prefix of <span class="math notranslate nohighlight">\(x_{n+1}\)</span>, the branching entropy of <span class="math notranslate nohighlight">\(x_n\)</span> will likely be smaller than that of <span class="math notranslate nohighlight">\(x_{n+1}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    h(x_n) &lt; h(x_{n+1})
    \]</div>
</li>
<li><p>There are three boundary conditions to decide whether <span class="math notranslate nohighlight">\(x_n\)</span> is a word boundary:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(B_{max}\)</span>: If <span class="math notranslate nohighlight">\(h(x_n) &gt; \text{val}_{max}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(B_{increase}\)</span>: <span class="math notranslate nohighlight">\(h(x_n) &gt; h(x_{n-1})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(B_{ordinary}\)</span>: <span class="math notranslate nohighlight">\(h(x_n) &gt; \text{val}_{ordinary}\)</span></p></li>
</ol>
</li>
</ul>
<p><img alt="" src="../../../_images/branching_entropy.png" /></p>
</section>
</section>
<section id="word-segmentation-in-practice">
<h2>Word Segmentation in Practice<a class="headerlink" href="#word-segmentation-in-practice" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;like apples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;likes pineapples and apples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dislikes Apple and pineapple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;People dislike pineapples.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;An apple makes people healthy.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pine trees make pineapple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pineapple unhealthy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;likeness of apples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dislikeness of pineapples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;health of pineapple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;healthiness of apple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;display of pineapples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unhealthy of apples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unhealthiness of pineapples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unlike apples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kindness of apples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kind of pineapples&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apple tree&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pineapple tree&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
<span class="kn">from</span> <span class="nn">ekorpkit.tokenizers.branching</span> <span class="kn">import</span> <span class="n">BranchingEntropyTokenizer</span>

<span class="n">bet</span> <span class="o">=</span> <span class="n">BranchingEntropyTokenizer</span><span class="p">()</span>
<span class="n">bet</span><span class="o">.</span><span class="n">train_from_iterator</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0c7806920cc34df28f2e0ca9d107a75f", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total words: 29
Top 10 words: [(&#39;▁of&#39;, 9), (&#39;▁apples&#39;, 6), (&#39;▁pineapples&#39;, 5), (&#39;▁pineapple&#39;, 5), (&#39;▁apple&#39;, 4), (&#39;▁and&#39;, 2), (&#39;▁people&#39;, 2), (&#39;▁unhealthy&#39;, 2), (&#39;▁tree&#39;, 2), (&#39;▁like&#39;, 1)]
Total words after filtering: 29
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7d975cb362a24fa1bc2442a308c63237", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total subwords: 543
Top 10 subwords: [(&#39;▁&#39;, 114), (&#39;e&#39;, 63), (&#39;p&#39;, 59), (&#39;l&#39;, 37), (&#39;a&#39;, 33), (&#39;s&#39;, 30), (&#39;i&#39;, 27), (&#39;n&#39;, 26), (&#39;pl&#39;, 24), (&#39;ple&#39;, 23)]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f7930052bc1c4886987b98c336523cbe", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "bee21fc74ed4416a9634182314f06a41", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequence</span> <span class="o">=</span> <span class="n">texts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bet</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bet</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">pre_tokenize</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dislikes apple and pineapple
[&#39;▁dislikes&#39;, &#39;▁apple&#39;, &#39;▁and&#39;, &#39;▁pineapple&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;pineapples&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">bet</span><span class="o">.</span><span class="n">find_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;p&#39;, 0.5250355693505371, 0.0),
 (&#39;i&#39;, 0.3496905752250248, -0.1753449941255123),
 (&#39;n&#39;, 0.3496905752250248, 0.0),
 (&#39;e&#39;, 0.44914649901267, 0.09945592378764523),
 (&#39;a&#39;, 0.3499656090752427, -0.0991808899374273),
 (&#39;p&#39;, 0.3499656090752427, 0.0),
 (&#39;p&#39;, 0.3499656090752427, 0.0),
 (&#39;l&#39;, 0.3499656090752427, 0.0),
 (&#39;e&#39;, 0.6764449241372277, 0.32647931506198496),
 (&#39;s&#39;, 0.5144984575880421, -0.16194646654918554)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_28_0.png" src="../../../_images/word_segmentation_28_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_29_0.png" src="../../../_images/word_segmentation_29_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenized</span> <span class="o">=</span> <span class="p">[</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">tokenized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[(&#39;▁like&#39;,), (&#39;▁apple&#39;, &#39;s&#39;)],
 [(&#39;▁like&#39;, &#39;s&#39;), (&#39;▁pineapple&#39;, &#39;s&#39;), (&#39;▁and&#39;,), (&#39;▁apple&#39;, &#39;s&#39;)],
 [(&#39;▁dis&#39;, &#39;like&#39;, &#39;s&#39;), (&#39;▁apple&#39;,), (&#39;▁and&#39;,), (&#39;▁pineapple&#39;,)],
 [(&#39;▁people&#39;,), (&#39;▁dis&#39;, &#39;like&#39;), (&#39;▁pineapple&#39;, &#39;s.&#39;)],
 [(&#39;▁an&#39;,), (&#39;▁apple&#39;,), (&#39;▁make&#39;, &#39;s&#39;), (&#39;▁people&#39;,), (&#39;▁health&#39;, &#39;y.&#39;)],
 [(&#39;▁pine&#39;,), (&#39;▁tree&#39;, &#39;s&#39;), (&#39;▁make&#39;,), (&#39;▁pineapple&#39;,)],
 [(&#39;▁pineapple&#39;,), (&#39;▁un&#39;, &#39;health&#39;, &#39;y&#39;)],
 [(&#39;▁like&#39;, &#39;ness&#39;), (&#39;▁of&#39;,), (&#39;▁apple&#39;, &#39;s&#39;)],
 [(&#39;▁dis&#39;, &#39;like&#39;, &#39;ness&#39;), (&#39;▁of&#39;,), (&#39;▁pineapple&#39;, &#39;s&#39;)],
 [(&#39;▁health&#39;,), (&#39;▁of&#39;,), (&#39;▁pineapple&#39;,)],
 [(&#39;▁health&#39;, &#39;iness&#39;), (&#39;▁of&#39;,), (&#39;▁apple&#39;,)],
 [(&#39;▁dis&#39;, &#39;play&#39;), (&#39;▁of&#39;,), (&#39;▁pineapple&#39;, &#39;s&#39;)],
 [(&#39;▁un&#39;, &#39;health&#39;, &#39;y&#39;), (&#39;▁of&#39;,), (&#39;▁apple&#39;, &#39;s&#39;)],
 [(&#39;▁un&#39;, &#39;health&#39;, &#39;iness&#39;), (&#39;▁of&#39;,), (&#39;▁pineapple&#39;, &#39;s&#39;)],
 [(&#39;▁un&#39;, &#39;like&#39;), (&#39;▁apple&#39;, &#39;s&#39;)],
 [(&#39;▁kind&#39;, &#39;ness&#39;), (&#39;▁of&#39;,), (&#39;▁apple&#39;, &#39;s&#39;)],
 [(&#39;▁kind&#39;,), (&#39;▁of&#39;,), (&#39;▁pineapple&#39;, &#39;s&#39;)],
 [(&#39;▁apple&#39;,), (&#39;▁tree&#39;,)],
 [(&#39;▁pineapple&#39;,), (&#39;▁tree&#39;,)]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenized</span> <span class="o">=</span> <span class="p">[</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">tokenized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;▁like&#39;, &#39;▁appl&#39;, &#39;es&#39;],
 [&#39;▁likes&#39;, &#39;▁pine&#39;, &#39;appl&#39;, &#39;es&#39;, &#39;▁a&#39;, &#39;nd&#39;, &#39;▁appl&#39;, &#39;es&#39;],
 [&#39;▁dis&#39;, &#39;likes&#39;, &#39;▁ap&#39;, &#39;ple&#39;, &#39;▁a&#39;, &#39;nd&#39;, &#39;▁pine&#39;, &#39;ap&#39;, &#39;ple&#39;],
 [&#39;▁people&#39;, &#39;▁dis&#39;, &#39;like&#39;, &#39;▁pineapples.&#39;],
 [&#39;▁an&#39;, &#39;▁ap&#39;, &#39;ple&#39;, &#39;▁makes&#39;, &#39;▁people&#39;, &#39;▁healthy.&#39;],
 [&#39;▁pine&#39;, &#39;▁tre&#39;, &#39;es&#39;, &#39;▁make&#39;, &#39;▁pine&#39;, &#39;ap&#39;, &#39;ple&#39;],
 [&#39;▁pine&#39;, &#39;ap&#39;, &#39;ple&#39;, &#39;▁unhealthy&#39;],
 [&#39;▁like&#39;, &#39;ness&#39;, &#39;▁of&#39;, &#39;▁appl&#39;, &#39;es&#39;],
 [&#39;▁dis&#39;, &#39;like&#39;, &#39;ness&#39;, &#39;▁of&#39;, &#39;▁pine&#39;, &#39;appl&#39;, &#39;es&#39;],
 [&#39;▁health&#39;, &#39;▁of&#39;, &#39;▁pine&#39;, &#39;ap&#39;, &#39;ple&#39;],
 [&#39;▁healthi&#39;, &#39;ness&#39;, &#39;▁of&#39;, &#39;▁ap&#39;, &#39;ple&#39;],
 [&#39;▁display&#39;, &#39;▁of&#39;, &#39;▁pine&#39;, &#39;appl&#39;, &#39;es&#39;],
 [&#39;▁unhealthy&#39;, &#39;▁of&#39;, &#39;▁appl&#39;, &#39;es&#39;],
 [&#39;▁un&#39;, &#39;healthi&#39;, &#39;ness&#39;, &#39;▁of&#39;, &#39;▁pine&#39;, &#39;appl&#39;, &#39;es&#39;],
 [&#39;▁un&#39;, &#39;like&#39;, &#39;▁appl&#39;, &#39;es&#39;],
 [&#39;▁kind&#39;, &#39;ness&#39;, &#39;▁of&#39;, &#39;▁appl&#39;, &#39;es&#39;],
 [&#39;▁ki&#39;, &#39;nd&#39;, &#39;▁of&#39;, &#39;▁pine&#39;, &#39;appl&#39;, &#39;es&#39;],
 [&#39;▁ap&#39;, &#39;ple&#39;, &#39;▁tree&#39;],
 [&#39;▁pine&#39;, &#39;ap&#39;, &#39;ple&#39;, &#39;▁tree&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">naive_segment</span><span class="p">(</span><span class="s2">&quot;ilikeanapple&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;i&#39;, &#39;like&#39;, &#39;an&#39;, &#39;apple&#39;]
</pre></div>
</div>
</div>
</div>
<section id="word-segmentation-for-korean">
<h3>Word Segmentation for Korean<a class="headerlink" href="#word-segmentation-for-korean" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;아버지가 방에 들어가신다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;아버지는 방에 들어가셨다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방을 들다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;방을 나가다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방을 들고 나갔다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방이 방에 있었다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방은 방안에 있다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방은 방에 있었다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방을 방으로 들고 들어갔다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;가방을 들고 집으로 갔다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;방은 집안에 있다&quot;</span><span class="p">,</span>
    <span class="s2">&quot;집으로 가다&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekorpkit.tokenizers.branching</span> <span class="kn">import</span> <span class="n">BranchingEntropyTokenizer</span>

<span class="n">bet</span> <span class="o">=</span> <span class="n">BranchingEntropyTokenizer</span><span class="p">()</span>
<span class="n">bet</span><span class="o">.</span><span class="n">train_from_iterator</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0eb989311e5b4d91845965a7fa54958f", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total words: 23
Top 10 words: [(&#39;▁방에&#39;, 4), (&#39;▁가방을&#39;, 4), (&#39;▁들고&#39;, 3), (&#39;▁있었다&#39;, 2), (&#39;▁가방은&#39;, 2), (&#39;▁있다&#39;, 2), (&#39;▁집으로&#39;, 2), (&#39;▁아버지가&#39;, 1), (&#39;▁들어가신다&#39;, 1), (&#39;▁아버지는&#39;, 1)]
Total words after filtering: 23
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "88dc71606a93432ca700953159b2d6b2", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total subwords: 201
Top 10 subwords: [(&#39;▁&#39;, 70), (&#39;방&#39;, 15), (&#39;가&#39;, 12), (&#39;다&#39;, 12), (&#39;다▁&#39;, 12), (&#39;▁방&#39;, 8), (&#39;▁가&#39;, 8), (&#39;▁들&#39;, 7), (&#39;들&#39;, 7), (&#39;▁가방&#39;, 7)]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "19acad82ffb942108d1f592a667d18af", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f8c24622ac594b8395e64128f7cb4791", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenized</span> <span class="o">=</span> <span class="p">[</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">branching_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<span class="n">tokenized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;▁아버지&#39;, &#39;가&#39;, &#39;▁방에&#39;, &#39;▁들어가신다&#39;],
 [&#39;▁아버지&#39;, &#39;는&#39;, &#39;▁방에&#39;, &#39;▁들어가셨다&#39;],
 [&#39;▁가방&#39;, &#39;을&#39;, &#39;▁들다&#39;],
 [&#39;▁방을&#39;, &#39;▁나가다&#39;],
 [&#39;▁가방&#39;, &#39;을&#39;, &#39;▁들고&#39;, &#39;▁나갔다&#39;],
 [&#39;▁가방&#39;, &#39;이&#39;, &#39;▁방에&#39;, &#39;▁있었다&#39;],
 [&#39;▁가방&#39;, &#39;은&#39;, &#39;▁방안에&#39;, &#39;▁있다&#39;],
 [&#39;▁가방&#39;, &#39;은&#39;, &#39;▁방에&#39;, &#39;▁있었다&#39;],
 [&#39;▁가방&#39;, &#39;을&#39;, &#39;▁방으로&#39;, &#39;▁들고&#39;, &#39;▁들어갔다&#39;],
 [&#39;▁가방&#39;, &#39;을&#39;, &#39;▁들고&#39;, &#39;▁집으로&#39;, &#39;▁갔다&#39;],
 [&#39;▁방은&#39;, &#39;▁집안에&#39;, &#39;▁있다&#39;],
 [&#39;▁집으로&#39;, &#39;▁가다&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tokenized</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="n">branching_threshold</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span>
<span class="p">]</span>
<span class="n">tokenized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;▁아버지가&#39;, &#39;▁방에&#39;, &#39;▁들어가신다&#39;],
 [&#39;▁아버지는&#39;, &#39;▁방에&#39;, &#39;▁들어가셨다&#39;],
 [&#39;▁가&#39;, &#39;방을&#39;, &#39;▁들다&#39;],
 [&#39;▁방을&#39;, &#39;▁나가다&#39;],
 [&#39;▁가&#39;, &#39;방을&#39;, &#39;▁들고&#39;, &#39;▁나갔다&#39;],
 [&#39;▁가방이&#39;, &#39;▁방에&#39;, &#39;▁있었다&#39;],
 [&#39;▁가&#39;, &#39;방은&#39;, &#39;▁방안에&#39;, &#39;▁있다&#39;],
 [&#39;▁가&#39;, &#39;방은&#39;, &#39;▁방에&#39;, &#39;▁있었다&#39;],
 [&#39;▁가&#39;, &#39;방을&#39;, &#39;▁방&#39;, &#39;으로&#39;, &#39;▁들고&#39;, &#39;▁들어갔다&#39;],
 [&#39;▁가&#39;, &#39;방을&#39;, &#39;▁들고&#39;, &#39;▁집&#39;, &#39;으로&#39;, &#39;▁갔다&#39;],
 [&#39;▁방은&#39;, &#39;▁집안에&#39;, &#39;▁있다&#39;],
 [&#39;▁집&#39;, &#39;으로&#39;, &#39;▁가다&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">naive_segment</span><span class="p">(</span><span class="s2">&quot;아버지가방에들어가신다&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;아버지가&#39;, &#39;방에&#39;, &#39;들어가신다&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">naive_segment</span><span class="p">(</span><span class="s2">&quot;아버지가가방을들고가신다&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;아버지가&#39;, &#39;가방을&#39;, &#39;들고&#39;, &#39;가&#39;, &#39;신다&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="o">=</span><span class="s2">&quot;아버지가&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_40_0.png" src="../../../_images/word_segmentation_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="o">=</span><span class="s2">&quot;가방은&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_41_0.png" src="../../../_images/word_segmentation_41_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="o">=</span><span class="s2">&quot;가방은&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_42_0.png" src="../../../_images/word_segmentation_42_0.png" />
</div>
</div>
</section>
<section id="working-with-news-article-samples">
<h3>Working with news article samples<a class="headerlink" href="#working-with-news-article-samples" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekorpkit</span> <span class="kn">import</span> <span class="n">eKonf</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/entelecheia/ekorpkit-book/raw/main/assets/data/us_equities_news_sampled.zip&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;us_equities_news_sampled.parquet&quot;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">cached_path</span><span class="p">)</span>
<span class="n">texts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekorpkit.tokenizers.branching</span> <span class="kn">import</span> <span class="n">BranchingEntropyTokenizer</span>

<span class="n">bet</span> <span class="o">=</span> <span class="n">BranchingEntropyTokenizer</span><span class="p">()</span>
<span class="n">bet</span><span class="o">.</span><span class="n">train_from_iterator</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">min_frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b0ee5772dfa64b41b178329f96d6f421", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total words: 107685
Top 10 words: [(&#39;▁the&#39;, 715895), (&#39;▁to&#39;, 334075), (&#39;▁of&#39;, 314837), (&#39;▁in&#39;, 278030), (&#39;▁and&#39;, 274910), (&#39;▁a&#39;, 259527), (&#39;▁s&#39;, 169595), (&#39;▁for&#39;, 133255), (&#39;▁is&#39;, 130552), (&#39;▁on&#39;, 113286)]
Total words after filtering: 107685
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5238024027d04a5d9c653bf44b5a3387", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total subwords: 3019773
Top 10 subwords: [(&#39;▁&#39;, 26177132), (&#39;e&#39;, 7246161), (&#39;t&#39;, 5334633), (&#39;a&#39;, 4971213), (&#39;o&#39;, 4428694), (&#39;n&#39;, 4415394), (&#39;i&#39;, 4397713), (&#39;s&#39;, 4366700), (&#39;r&#39;, 4125315), (&#39;l&#39;, 2404918)]
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5a38b3b7e51444a69b5bb5d97713a8d2", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8a96d7f8e1fc4e61ae1e51ff40f257de", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;../data/tokenizers/&quot;</span><span class="p">,</span> <span class="s2">&quot;branching&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;../data/tokenizers/branching/vocab.json&#39;,
 &#39;../data/tokenizers/branching/config.json&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekorpkit.tokenizers.branching</span> <span class="kn">import</span> <span class="n">BranchingEntropyTokenizer</span>

<span class="n">bet</span> <span class="o">=</span> <span class="n">BranchingEntropyTokenizer</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;../data/tokenizers/&quot;</span><span class="p">,</span> <span class="s2">&quot;branching&quot;</span><span class="p">,</span> <span class="n">branching_threshold</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "735b57d1fe0e4ed7a79c95105a932e7a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "03c0262d4c8e40878c3549dc4f264f6e", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequence</span> <span class="o">=</span> <span class="s2">&quot;Investment opportunities in the company.&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;▁invest&#39;, &#39;ment&#39;), (&#39;▁oppo&#39;, &#39;rtunit&#39;, &#39;ies&#39;), (&#39;▁in&#39;,), (&#39;▁the&#39;,), (&#39;▁company.&#39;,)]
[(&#39;▁invest&#39;, &#39;ment&#39;), (&#39;▁opportun&#39;, &#39;ities&#39;), (&#39;▁in&#39;,), (&#39;▁the&#39;,), (&#39;▁company.&#39;,)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(bet.tokenize(texts[3], flatten=False, direction=&quot;forward&quot;, branching_threshold=0.3))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;investments&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">))</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">bet</span><span class="o">.</span><span class="n">find_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;▁invest&#39;, &#39;ments&#39;)]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;i&#39;, 1.0095287438501144, 0.0),
 (&#39;n&#39;, 1.1515486269045268, 0.14201988305441238),
 (&#39;v&#39;, 0.45972611324043794, -0.6918225136640888),
 (&#39;e&#39;, 0.4509164703468697, -0.008809642893568226),
 (&#39;s&#39;, 0.35903206546025535, -0.09188440488661437),
 (&#39;t&#39;, 0.9522316236050686, 0.5931995581448133),
 (&#39;m&#39;, 0.3465757022785438, -0.6056559213265249),
 (&#39;e&#39;, 0.3465757022785438, 0.0),
 (&#39;n&#39;, 0.3465757022785438, 0.0),
 (&#39;t&#39;, 0.6160316441204637, 0.26945594184191995),
 (&#39;s&#39;, 0.3519227033342969, -0.2641089407861668)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_51_0.png" src="../../../_images/word_segmentation_51_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;investments&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bet</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">))</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">bet</span><span class="o">.</span><span class="n">find_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;▁invest&#39;, &#39;ments&#39;)]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;i&#39;, 0.3561165131571915, -0.009533638447234705),
 (&#39;n&#39;, 0.3465828747099568, 0.026795502159956852),
 (&#39;v&#39;, 0.37337837686991365, -0.026795591191855372),
 (&#39;e&#39;, 0.3465827856780583, 0.13506944700263662),
 (&#39;s&#39;, 0.4816522326806949, 0.21807907607263988),
 (&#39;t&#39;, 0.6997313087533348, 0.624865765838529),
 (&#39;m&#39;, 1.3245970745918638, -0.1795732287232441),
 (&#39;e&#39;, 1.1450238458686197, -0.3379381071100026),
 (&#39;n&#39;, 0.8070857387586171, 0.5204781480063937),
 (&#39;t&#39;, 1.3275638867650108, 0.3191691594567949),
 (&#39;s&#39;, 1.6467330462218057, 0.0)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bet</span><span class="o">.</span><span class="n">plot_local_entropy</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/word_segmentation_53_0.png" src="../../../_images/word_segmentation_53_0.png" />
</div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://lovit.github.io/nlp/2018/04/09/branching_entropy_accessor_variety/">Uncertanty to word boundary; Accessor Variety &amp; Branching Entropy</a></p></li>
<li><p><a class="reference external" href="https://medium.com/towards-data-science/fast-word-segmentation-for-noisy-text-2c2c41f9e8da">Fast Word Segmentation of Noisy Text</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs/lectures/intro_nlp"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="tokenization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Tokenization</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="vectorization.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Vector Semantics and Representation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Young Joon Lee<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>