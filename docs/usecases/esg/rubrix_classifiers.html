
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Preparing classifiers for active learning &#8212; eKorpkit Tutorials</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/ekorpkit.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Preparing active learning data" href="predict_for_learning.html" />
    <link rel="prev" title="Predicting ESG Categories and Polarities" href="predict_news.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FN4GFT8HP8"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-FN4GFT8HP8');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/ekorpkit.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">eKorpkit Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    eKonomic Research Python Toolkit
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/index.html">
   Getting started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/usage.html">
     Usage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/features/index.html">
   Key features
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/easy_config.html">
     Easy Configuration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/no_boiler.html">
     No Boilerplate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/workflows.html">
     Workflows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/share.html">
     Sharable and Reproducible
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/features/plug.html">
     Pluggable Architece
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/config/index.html">
   Configuring ekorpkit
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/config/eKonf.html">
     Using eKonf class
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/datasets/index.html">
   Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/corpora/corpus.html">
     Build and Load Corpora
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/datasets/dataset.html">
     Build and Load Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/corpora/pipeline.html">
     Corpus task pipelines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/models/index.html">
   Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/models/automl/index.html">
     Auto ML
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/models/embeddings/index.html">
     Word Embeddings
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/embeddings/word2vec_basics.html">
       Word2Vec Basics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/embeddings/eval_vectors.html">
       Evaluate pretrained embeddings
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/models/ngram/index.html">
     N-Grams
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/ngram/ngram.html">
       N-Grams
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/ngram/ngram_for_lexicons.html">
       N-Gram model for ngram lexicon features
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/ngram/ngram_for_words.html">
       N-Gram model for unigram lexicon features
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/models/sentiment/index.html">
     Sentiment Analyers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/sentiment/lbsa_en.html">
       Lexicon-based Sentiment Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/sentiment/financial_phrasebank_lm.html">
       Evaluate LM with financial phrasebank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/models/sentiment/sentiment.html">
       LM Dictionary vs. finbert vs. T5
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/models/transformers/index.html">
     Transformers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/pipelines/index.html">
   Pipelines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/pipelines/pipeline.html">
     Instantiating pipeline
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/preprocessors/index.html">
   Preprocessors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/preprocessors/normalizer/index.html">
     Normalizers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/preprocessors/normalizer/normalizer.html">
       Normalizers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/preprocessors/segmenter/index.html">
     Segmenters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/preprocessors/segmenter/segmenter.html">
       Segmenters
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../tutorials/preprocessors/tokenizer/index.html">
     Tokenizers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../tutorials/preprocessors/tokenizer/mecab.html">
       Mecab Tokenizer
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tutorials/visualizers/index.html">
   Visualizers
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tutorials/visualizers/plot.html">
     Plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/workflow/index.html">
   Workflows
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../corpus/ekorpkot_corpus.html">
   The eKorpkit Corpus
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Use Cases
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../fomc/index.html">
   FOMC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/02_FOMC_numerical_data.html">
     Preparing Numerical Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/03_FOMC_corpus.html">
     Preparing Textual Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/04_FOMC_EDA_numericals.html">
     EDA on Numerical Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/05_FOMC_features.html">
     Visualizing Features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/06_FOMC_AutoML.html">
     Checking Baseline with AutoML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/07_FOMC_sentiments.html">
     Predicting Sentiments of FOMC Corpus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/08_FOMC_EDA_sentiments.html">
     EDA on Sentiment Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fomc/09_FOMC_AutoML_with_tones.html">
     Predicting the next decisions with tones
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bok/index.html">
   Bank of Korea
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../edgar/index.html">
   EDGAR
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../edgar/predict_edgar.html">
     Prediciting Sentiments
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   ESG
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="snorkel-polarity.html">
     Preparing polarity classification datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rubrix.html">
     Improving classification datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="classifiers.html">
     Training Classifiers for ESG Ratings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="econ_news_corpus.html">
     Building
     <code class="docutils literal notranslate">
      <span class="pre">
       econ_news_kr
      </span>
     </code>
     corpus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="predict_news.html">
     Predicting ESG Categories and Polarities
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Preparing classifiers for active learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="predict_for_learning.html">
     Preparing active learning data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../esg-en/index.html">
   ESG (English)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../esg-en/esg_corpus.html">
     Building
     <code class="docutils literal notranslate">
      <span class="pre">
       JOCo
      </span>
     </code>
     corpus
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cointax/index.html">
   Taxation on Cryptocurrency
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cointax/coin_dataset.html">
     Improving classification datasets
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Research
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../research/esg_topics/analyst.html">
   ESG Topic Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../research/esg_topics/rethink_esg.html">
   Rethinking ESG
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../lectures/intro_nlp/index.html">
   Introduction to NLP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/ekorpkit.html">
     Getting started with ekorpkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/research.html">
     Research Applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/topic.html">
     Topic Modeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/topic_models.html">
     Topic Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/topic_coherence.html">
     Topic Coherence Measures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/sentiments.html">
     Sentiment Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/tokenization.html">
     Tokenization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/word_segmentation.html">
     Word Segmentation and Association
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/vectorization.html">
     Vector Semantics and Representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/language_models.html">
     Language Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/lab1-corpus.html">
     Lab 1: Preparing Wikipedia Corpora
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/intro_nlp/lab2-corpus-eda.html">
     Lab 2: EDA on Corpora
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../lectures/deep_nlp/index.html">
   Deep Learning for NLP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/ekorpkit.html">
     Getting started with ekorpkit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/zeroshot.html">
     Zero Shot, Prompt, and Search Strategies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/bloom.html">
     What is BLOOM?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/bloom_apps.html">
     Bloom Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/transformers.html">
     Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/bert.html">
     BERT: Bidirectional Encoder Representations from Transformers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/t5.html">
     T5: Text-To-Text Transfer Transformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/tokenization.html">
     Tokenization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/sentencepiece.html">
     SentencePiece Tokenizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/byt5.html">
     ByT5: Towards a token-free future with pre-trained byte-to-byte models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/lab1-corpus.html">
     Lab 1: Preparing Wikipedia Corpora
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/lab2-corpus-eda.html">
     Lab 2: EDA on Corpora
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/deep_nlp/lab3-train-tokenizers.html">
     Lab 3: Training Tokenizers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../lectures/aiart/index.html">
   AI Art (Text-to-Image)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/project-themes.html">
     Project Themes - A Brave New World
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/dalle1.html">
     DALL·E 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/dalle2.html">
     DALL·E 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/imagen.html">
     Imagen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/dalle-mini.html">
     DALL·E Mini
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/disco.html">
     Disco Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/disco_batch.html">
     Disco Diffusion Batch Generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/stable-diffusion.html">
     Stable Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/prompt-generator.html">
     Prompt Generator for Stable Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/textual-inversion.html">
     Textual Inversion (Dreambooth)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/whisper.html">
     Automatic Speech Recognition (Whisper)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/text2music.html">
     Text to Music
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../lectures/aiart/image2music.html">
     Image to Music
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/mlops/index.html">
   Machine Learning Systems Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/ds/index.html">
   Data Science for Economics and Finance
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/index.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/cite.html">
   Citation
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/entelecheia/ekorpkit-book/main?urlpath=tree/ekorpkit-book/docs/usecases/esg/rubrix_classifiers.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/entelecheia/ekorpkit-book/blob/main/ekorpkit-book/docs/usecases/esg/rubrix_classifiers.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/entelecheia/ekorpkit-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/entelecheia/ekorpkit-book/issues/new?title=Issue%20on%20page%20%2Fdocs/usecases/esg/rubrix_classifiers.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/docs/usecases/esg/rubrix_classifiers.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-an-invalid-dataset">
   Build an invalid dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-an-invalid-classficiation-model">
   Train an invalid classficiation model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-esg-topics-improved-dataset">
   Prepare
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_topics_improved
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-a-valid-topic-dataset">
   Build a valid topic dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-validate-esg-valid-topics-kr-dataset">
   Cross-validate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_valid_topics_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-cross-validated-esg-cv-topics-kr-dataset">
   Build cross-validated
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_topics_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-and-evaluate-esg-cv-topics-kr-dataset">
   Train and evaluate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_topics_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-esg-polarity-kr-dataset">
   Prepare
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-a-valid-polarity-dataset">
   Build a valid polarity dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-validate-esg-polarity-kr-dataset">
   Cross-validate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-cross-validated-esg-cv-polarity-kr-dataset">
   Build cross-validated
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-and-evaluate-esg-cv-polarity-kr-dataset">
   Train and evaluate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Preparing classifiers for active learning</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-an-invalid-dataset">
   Build an invalid dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-an-invalid-classficiation-model">
   Train an invalid classficiation model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-esg-topics-improved-dataset">
   Prepare
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_topics_improved
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-a-valid-topic-dataset">
   Build a valid topic dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-validate-esg-valid-topics-kr-dataset">
   Cross-validate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_valid_topics_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-cross-validated-esg-cv-topics-kr-dataset">
   Build cross-validated
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_topics_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-and-evaluate-esg-cv-topics-kr-dataset">
   Train and evaluate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_topics_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-esg-polarity-kr-dataset">
   Prepare
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-a-valid-polarity-dataset">
   Build a valid polarity dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-validate-esg-polarity-kr-dataset">
   Cross-validate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-cross-validated-esg-cv-polarity-kr-dataset">
   Build cross-validated
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-and-evaluate-esg-cv-polarity-kr-dataset">
   Train and evaluate
   <code class="docutils literal notranslate">
    <span class="pre">
     esg_cv_polarity_kr
    </span>
   </code>
   dataset
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="preparing-classifiers-for-active-learning">
<h1>Preparing classifiers for active learning<a class="headerlink" href="#preparing-classifiers-for-active-learning" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">ekorpkit</span> <span class="kn">import</span> <span class="n">eKonf</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">setLogger</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;version:&quot;</span><span class="p">,</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;is notebook?&quot;</span><span class="p">,</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">is_notebook</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;is colab?&quot;</span><span class="p">,</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">is_colab</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;evironment varialbles:&quot;</span><span class="p">)</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">eKonf</span><span class="o">.</span><span class="n">env</span><span class="p">()</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>version: 0.1.39.post0.dev3
is notebook? True
is colab? False
evironment varialbles:
{&#39;CUDA_DEVICE_ORDER&#39;: None,
 &#39;CUDA_VISIBLE_DEVICES&#39;: None,
 &#39;EKORPKIT_CONFIG_DIR&#39;: &#39;/workspace/projects/ekorpkit-book/config&#39;,
 &#39;EKORPKIT_DATA_DIR&#39;: None,
 &#39;EKORPKIT_LOG_LEVEL&#39;: &#39;WARNING&#39;,
 &#39;EKORPKIT_PROJECT&#39;: &#39;ekorpkit-book&#39;,
 &#39;EKORPKIT_WORKSPACE_ROOT&#39;: &#39;/workspace&#39;,
 &#39;KMP_DUPLICATE_LIB_OK&#39;: &#39;TRUE&#39;,
 &#39;NUM_WORKERS&#39;: 230}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;../data/esg&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="build-an-invalid-dataset">
<h2>Build an invalid dataset<a class="headerlink" href="#build-an-invalid-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rb_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s1">&#39;model/rubrix&#39;</span><span class="p">)</span>
<span class="n">rb_cfg</span><span class="o">.</span><span class="n">auto</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">rb</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">rb_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Loaded .env from /workspace/projects/ekorpkit-book/config/.env
INFO:ekorpkit.base:setting environment variable CACHED_PATH_CACHE_ROOT to /workspace/.cache/cached_path
INFO:ekorpkit.base:setting environment variable KMP_DUPLICATE_LIB_OK to TRUE
INFO:ekorpkit.base:Loaded .env from /workspace/projects/ekorpkit-book/config/.env
INFO:ekorpkit.base:Loaded .env from /workspace/projects/ekorpkit-book/config/.env
INFO:ekorpkit.base:Loaded .env from /workspace/projects/ekorpkit-book/config/.env
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rb_category_dataset</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;esg_category_prediction_check&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;annotation&quot;</span><span class="p">]</span>
<span class="n">invalid_dataset</span> <span class="o">=</span> <span class="n">rb_category_dataset</span><span class="p">[</span>
    <span class="n">rb_category_dataset</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;Discarded&quot;</span><span class="p">,</span> <span class="s2">&quot;Validated&quot;</span><span class="p">])</span>
<span class="p">][</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;labels&quot;</span><span class="p">})</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_invalid_data.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">invalid_dataset</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset=dataset_build&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_invalid_kr&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">build</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">stratify_on</span> <span class="o">=</span> <span class="s2">&quot;labels&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">123</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">reset_index</span><span class="o">.</span><span class="n">drop_index</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">esg_invalid_ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">esg_invalid_ds</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function load_dataframe at 0x7f2afb939a60&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function reset_index at 0x7f2afb932ca0&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function split_sampling at 0x7f2afb9328b0&gt;)
INFO:ekorpkit.base:Using batcher with minibatch size: 2
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3050488372784c6eb4d713ee2de9671b", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 1
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4ba8f81ce9174736b8a30ab440ebbb1b", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 1
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ca920f3326804898ac412024ef2a6599", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">esg_invalid_ds</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>labels</th>
      <th>annotation</th>
      <th>split</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>■ 삼성SDI는 합작사 설립\n배터리 사업을 전개하고 있는 삼성SDI는 양극제 제조...</td>
      <td>Discarded</td>
      <td>None</td>
      <td>train</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26일 LG그룹은 전날부터 이틀간 진행된 계열사 이사회를 통해 총 177명의 승진 ...</td>
      <td>Validated</td>
      <td>G-지배구조</td>
      <td>train</td>
    </tr>
    <tr>
      <th>2</th>
      <td>비어만 사장은 그럼에도 현대차가 배터리 자체 개발 및 생산기술 확보를 추진 중이라는...</td>
      <td>Discarded</td>
      <td>None</td>
      <td>train</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019년 모바일TV ‘몰리브’를 출범하며 라이브 커머스 시장에 첫발을 내디딘 롯데...</td>
      <td>Discarded</td>
      <td>None</td>
      <td>train</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SNE리서치는 글로벌 배터리 수요가 2020년 139GWh에서 2030년 3254G...</td>
      <td>Discarded</td>
      <td>None</td>
      <td>train</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>366</th>
      <td>ICT업계 개발자 구인난 심화 속\n개발자 몸값이 치솟자 인문·사회계 비전공자들도 ...</td>
      <td>Validated</td>
      <td>S-고용</td>
      <td>test</td>
    </tr>
    <tr>
      <th>367</th>
      <td>조직 재정비로 생겨난 여력은 미래 먹거리에 집중했다. 키워야 할 사업이라 판단되면 ...</td>
      <td>Discarded</td>
      <td>None</td>
      <td>test</td>
    </tr>
    <tr>
      <th>368</th>
      <td>[헤럴드경제=양대근 기자] SK이노베이션은 최근 미국 특허심판원(PTAB)에 제기한...</td>
      <td>Validated</td>
      <td>G-기업윤리/불공정/소송</td>
      <td>test</td>
    </tr>
    <tr>
      <th>369</th>
      <td>LG화학과 SK이노베이션 배터리를 장착한 친환경차가 포함됐다. LG화학은 파나소닉과...</td>
      <td>Discarded</td>
      <td>None</td>
      <td>test</td>
    </tr>
    <tr>
      <th>370</th>
      <td>그동안 줄곧 투자만 해 수익을 내지 못하던 전지사업부문은 지난 2분기에 실제 이익을...</td>
      <td>Validated</td>
      <td>G-지배구조</td>
      <td>test</td>
    </tr>
  </tbody>
</table>
<p>371 rows × 4 columns</p>
</div></div></div>
</div>
</section>
<section id="train-an-invalid-classficiation-model">
<h2>Train an invalid classficiation model<a class="headerlink" href="#train-an-invalid-classficiation-model" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_invalid_kr&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>

<span class="n">overrides</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;+model/transformer=classification&quot;</span><span class="p">,</span>
    <span class="s2">&quot;+model/transformer/pretrained=ekonelectra-base&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;model/transformer=classification&quot;</span><span class="p">,</span> <span class="n">overrides</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_invalid&quot;</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Validated&quot;</span><span class="p">,</span> <span class="s2">&quot;Discarded&quot;</span><span class="p">]</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_method_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;eval&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="prepare-esg-topics-improved-dataset">
<h2>Prepare <code class="docutils literal notranslate"><span class="pre">esg_topics_improved</span></code> dataset<a class="headerlink" href="#prepare-esg-topics-improved-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_topics_improved&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;/workspace/data/datasets/simple&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">ds_cfg</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">]</span>
<span class="n">existing_data</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">existing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_topics_existing.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">existing_data</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(11054, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_group</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_topics_valid&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">_pipeline_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">]</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_cfg</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-preds.parquet&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">topic_valid_preds_df</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">topic_valid_preds_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function predict at 0x7f2afb932e50&gt;)
INFO:ekorpkit.base:Calling train
Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.out_proj.bias&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.dense.weight&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6835c48289c840fa99cfd064da287a5e", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (523 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3b17ffa2996348119286692a00d5572b", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:p7or7r6x) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7e231585596f40dea9afb75f7020c7ae", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">prime-water-4</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid/runs/p7or7r6x" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid/runs/p7or7r6x</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_invalid/ekonelectra-base/wandb/run-20220919_090235-p7or7r6x/logs</code></div><div class="output text_html">Successfully finished last run (ID:p7or7r6x). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8866902dcbc14731bdeb41bdbbb26201", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_invalid/ekonelectra-base/wandb/run-20220919_092838-2oivm1t2</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid/runs/2oivm1t2" target="_blank">prime-valley-5</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "180d1f9e539e435a8d84d2387d89c487", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ca133bf72de1453ebf35e25d2aa2b79a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8ae9c95b038543b7a8982ff562b0ab74", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8b5d2e1d7dad4727a5336e8020f5857e", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1f9b8a1fb36648449134a694a6ce0277", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:2oivm1t2) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "51c19c76564144dfb4b4546773797486", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>acc</td><td>▁█▅</td></tr><tr><td>eval_loss</td><td>▁▁█</td></tr><tr><td>fn</td><td>▁█▅</td></tr><tr><td>fp</td><td>█▁▅</td></tr><tr><td>global_step</td><td>▁▅█</td></tr><tr><td>mcc</td><td>▁█▅</td></tr><tr><td>tn</td><td>▁█▅</td></tr><tr><td>tp</td><td>█▁▅</td></tr><tr><td>train_loss</td><td>▆▁█</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>acc</td><td>0.55</td></tr><tr><td>eval_loss</td><td>0.70578</td></tr><tr><td>fn</td><td>11</td></tr><tr><td>fp</td><td>16</td></tr><tr><td>global_step</td><td>48</td></tr><tr><td>mcc</td><td>0.08704</td></tr><tr><td>tn</td><td>12</td></tr><tr><td>tp</td><td>21</td></tr><tr><td>train_loss</td><td>0.90013</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">prime-valley-5</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid/runs/2oivm1t2" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid/runs/2oivm1t2</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_invalid/ekonelectra-base/wandb/run-20220919_092838-2oivm1t2/logs</code></div><div class="output text_html">Successfully finished last run (ID:2oivm1t2). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ae09959869b548efbe48fefa217b117e", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_invalid/ekonelectra-base/wandb/run-20220919_092902-2ngg0tpm</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid/runs/2ngg0tpm" target="_blank">giddy-fire-6</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_invalid" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Calling eval
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c2ee88d8a3734fc29767f609ac6d00e1", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "90aca9165fe949df9d2e59905a1a0197", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.6666666666666666
Precison:  0.6767676767676769
Recall:  0.6666666666666666
F1 Score:  0.6658364466583645
Model Report: 
___________________________________________________
              precision    recall  f1-score   support

   Discarded       0.62      0.74      0.68        35
   Validated       0.73      0.60      0.66        40

    accuracy                           0.67        75
   macro avg       0.67      0.67      0.67        75
weighted avg       0.68      0.67      0.67        75
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9f5a8d1535b84db983cb4deb517ee28e", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (731 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "26da8498611f4a36a345bd8f78476183", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>labels</th>
      <th>pred_labels</th>
      <th>raw_preds</th>
      <th>pred_probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>특히 , 벤처기업협회 는 조달청 이 혁신 조달시장 플랫폼 으로서 수요 기술 의 예고...</td>
      <td>S-기업(공급망)동반성장/상생</td>
      <td>Validated</td>
      <td>{'Discarded': 0.3987556591183646, 'Validated':...</td>
      <td>0.601244</td>
    </tr>
    <tr>
      <th>1</th>
      <td>( sk하이닉스 ) , 경쟁력 강화 및 고객 확보 를 위해 파운드리 사업부 분사 추...</td>
      <td>G-지배구조</td>
      <td>Discarded</td>
      <td>{'Discarded': 0.542485316149969, 'Validated': ...</td>
      <td>0.542485</td>
    </tr>
    <tr>
      <th>2</th>
      <td>주주 활동 의 성공 지표 주주 활동 이 성공 했다고 하는 경우 기업 과 투자자 의 ...</td>
      <td>G-지배구조</td>
      <td>Validated</td>
      <td>{'Discarded': 0.4702285533016523, 'Validated':...</td>
      <td>0.529771</td>
    </tr>
    <tr>
      <th>3</th>
      <td>이 들 은 자문 명목 으로만 1 인 당 수천만 원에서 많게는 수억 원을 받은 것으로...</td>
      <td>G-기업윤리/불공정/소송</td>
      <td>Validated</td>
      <td>{'Discarded': 0.4589559988355822, 'Validated':...</td>
      <td>0.541044</td>
    </tr>
    <tr>
      <th>4</th>
      <td>대법 ' 증권 신고서 등 일부 잘못 있어도 증권사 책임 없어 '... 왜 ?\n증권...</td>
      <td>G-기업윤리/불공정/소송</td>
      <td>Validated</td>
      <td>{'Discarded': 0.4195118091144356, 'Validated':...</td>
      <td>0.580488</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../../_images/rubrix_classifiers_13_38.png" src="../../../_images/rubrix_classifiers_13_38.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valid_existing_data</span> <span class="o">=</span> <span class="n">topic_valid_preds_df</span><span class="p">[</span>
    <span class="n">topic_valid_preds_df</span><span class="o">.</span><span class="n">pred_labels</span> <span class="o">==</span> <span class="s2">&quot;Validated&quot;</span>
<span class="p">][</span><span class="n">cols</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">valid_existing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6004, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;annotation&quot;</span><span class="p">]</span>
<span class="n">valid_dataset</span> <span class="o">=</span> <span class="n">rb_category_dataset</span><span class="p">[</span>
    <span class="n">rb_category_dataset</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;Validated&quot;</span><span class="p">])</span>
<span class="p">][</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;annotation&quot;</span><span class="p">:</span> <span class="s2">&quot;labels&quot;</span><span class="p">})</span>
<span class="n">new_topic_dataset</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">concat_data</span><span class="p">([</span><span class="n">valid_dataset</span><span class="p">,</span> <span class="n">valid_existing_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_topic_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_rubrix_topic_data.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">new_topic_dataset</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6202, 2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-a-valid-topic-dataset">
<h2>Build a valid topic dataset<a class="headerlink" href="#build-a-valid-topic-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_rubrix_topic_data.parquet&quot;</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset=dataset_build&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_topics_kr&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">build</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">stratify_on</span> <span class="o">=</span> <span class="s2">&quot;labels&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">reset_index</span><span class="o">.</span><span class="n">drop_index</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">esg_valid_topic_ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">esg_valid_topic_ds</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function load_dataframe at 0x7f29d12260d0&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function reset_index at 0x7f29d1225310&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function split_sampling at 0x7f29d1221ee0&gt;)
INFO:ekorpkit.base:Using batcher with minibatch size: 18
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0c5f702964f649f4bee2800460b89ced", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 5
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1937a7b26be44b1590f7a6d2160bb65d", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 6
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2160afd7e99546d78315e4357577634d", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="cross-validate-esg-valid-topics-kr-dataset">
<h2>Cross-validate <code class="docutils literal notranslate"><span class="pre">esg_valid_topics_kr</span></code> dataset<a class="headerlink" href="#cross-validate-esg-valid-topics-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_topics_kr&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>

<span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=ekonelectra-base&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s1">&#39;model/transformer=classification&#39;</span><span class="p">,</span> <span class="n">overrides</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_topics&quot;</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_method_</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>

<span class="n">cv_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cross_val_predict</span><span class="p">(</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv_preds</span> <span class="o">=</span> <span class="n">cv_preds</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">})</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">cv_preds</span><span class="p">,</span> <span class="s2">&quot;esg_valid_topics_cv.parquet&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:No method defined to call
Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dbac6b77764b499eb5cd6d065330ece8", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (712 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2343fd52893a46a9873a0c7bd9cd81da", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:158wduud) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "229708e0c4f04a03998acb26e64d38f9", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">cosmic-frost-18</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/158wduud" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/158wduud</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_005201-158wduud/logs</code></div><div class="output text_html">Successfully finished last run (ID:158wduud). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dff83a37cec642edb4ac0e578b5869f0", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010015-2ceyf1n4</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2ceyf1n4" target="_blank">hardy-galaxy-19</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5b3a49e83c0740969bccc5880cfdc6dc", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7ca83dd16afb4308948a89e14e746dee", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0abeb259d78e4ee08f1cd1d0287d9ecd", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c570bb2e7781404b8afa356a02def48e", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5aef5eac010f40a89ef14c65b244db81", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "65f8096af77042fe968e2c9413993759", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6bea83b44f9344fdbfa48a65155e5ad5", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:2ceyf1n4) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2d38ef8a0fbc4529b0da34415b4123cf", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▆▄▄▃▄▃▂▂▁▂▂▁</td></tr><tr><td>acc</td><td>▁▆▇██</td></tr><tr><td>eval_loss</td><td>█▃▂▁▁</td></tr><tr><td>global_step</td><td>▁▂▂▂▃▃▃▄▅▅▅▆▆▆▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▆▅▅▄▃▃▂▂▁</td></tr><tr><td>mcc</td><td>▁▆▇██</td></tr><tr><td>train_loss</td><td>▄█▁▁▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.08486</td></tr><tr><td>acc</td><td>0.78751</td></tr><tr><td>eval_loss</td><td>0.73779</td></tr><tr><td>global_step</td><td>650</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.75302</td></tr><tr><td>train_loss</td><td>0.08486</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">hardy-galaxy-19</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2ceyf1n4" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2ceyf1n4</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010015-2ceyf1n4/logs</code></div><div class="output text_html">Successfully finished last run (ID:2ceyf1n4). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "64b87b015dda4334921d6e25fb088b23", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010205-by3oe75k</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/by3oe75k" target="_blank">icy-mountain-20</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "918f3647b1c541e0989b8920d26ddb98", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (731 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9834f5c800104623a945f326603ee628", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c790e6bb0d104484b9de397f3bfb6cda", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (731 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e5f47398d54748fe918f85d3e4da5586", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:by3oe75k) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8bf716be2f6146ca85594e8db9be497c", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">icy-mountain-20</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/by3oe75k" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/by3oe75k</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010205-by3oe75k/logs</code></div><div class="output text_html">Successfully finished last run (ID:by3oe75k). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "82c5c0e2e01e4be79f9b0ca2235d13d8", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010232-1m5majkn</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1m5majkn" target="_blank">rural-violet-21</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f99eebbad949443b9a80c9184f76b4b1", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "79f0a252281b4115aa1eb94044ce5f4c", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "af184562e8c541d3a1b18ec90666523d", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "66e8de0d957c471a8c017adc11f13a42", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "2842765a85a54bd49283025daecf22e3", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cd0b8fa5010e41b1ae816dd0a7a92db1", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "380f56f20e5441fd8e288bfcc75aa52c", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1m5majkn) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ce289833a70248d9bbe35de92b80f02e", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▆▅▄▃▃▂▂▅▄▂▁▁</td></tr><tr><td>acc</td><td>▁▅▇██</td></tr><tr><td>eval_loss</td><td>█▄▂▁▁</td></tr><tr><td>global_step</td><td>▁▂▂▂▃▃▃▄▅▅▅▆▆▆▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▆▅▅▄▃▃▂▂▁</td></tr><tr><td>mcc</td><td>▁▅▇██</td></tr><tr><td>train_loss</td><td>█▆▂▅▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.2548</td></tr><tr><td>acc</td><td>0.77039</td></tr><tr><td>eval_loss</td><td>0.80148</td></tr><tr><td>global_step</td><td>650</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.73421</td></tr><tr><td>train_loss</td><td>0.2548</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">rural-violet-21</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1m5majkn" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1m5majkn</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010232-1m5majkn/logs</code></div><div class="output text_html">Successfully finished last run (ID:1m5majkn). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ceddd0baa96b41c9a8c5087073475eea", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010421-2s63fdzf</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2s63fdzf" target="_blank">zany-darkness-22</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "76b53322b3a5484ab6d8ad61f498bd8f", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "43a9c2269ce54209bd49ac50dae40cd4", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5c53928629954312b60bddc77852ecf1", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (691 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "67ae11dcc15341eda84657b81b2e8001", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:2s63fdzf) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "84682d34cb5740fc979bf8d9082f2f46", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">zany-darkness-22</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2s63fdzf" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2s63fdzf</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010421-2s63fdzf/logs</code></div><div class="output text_html">Successfully finished last run (ID:2s63fdzf). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "32620cf7de6541aa88baf56fba090674", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010448-1gss34v9</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1gss34v9" target="_blank">fragrant-flower-23</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5a1814910fb745ec984a162df8ebd58a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ef7d4c99d12142d187bb35b0bcf592b9", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cab378adc50d42079d2013cee08b3aa5", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "859c89b549694223bf5fe340ff0d25da", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "59ae6eb963eb4490902d2fa87fe12efc", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c25d8d92c3714fadb639ce7b6f286751", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b8c603db9e61411da2f0d0b02233effa", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1gss34v9) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1345d22887be4f79bc8869c1ea247869", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▅▅▅▃▂▅▂▂▁▂▁▂</td></tr><tr><td>acc</td><td>▁▅▇██</td></tr><tr><td>eval_loss</td><td>█▃▁▁▁</td></tr><tr><td>global_step</td><td>▁▂▂▂▃▃▃▄▅▅▅▆▆▆▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▆▅▅▄▃▃▂▂▁</td></tr><tr><td>mcc</td><td>▁▅▇██</td></tr><tr><td>train_loss</td><td>█▄▆▁▂</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.46394</td></tr><tr><td>acc</td><td>0.78147</td></tr><tr><td>eval_loss</td><td>0.82527</td></tr><tr><td>global_step</td><td>650</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.74724</td></tr><tr><td>train_loss</td><td>0.46394</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">fragrant-flower-23</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1gss34v9" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1gss34v9</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010448-1gss34v9/logs</code></div><div class="output text_html">Successfully finished last run (ID:1gss34v9). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c997985171754a8ea97c45cc539d393e", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010633-3w3bkjug</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/3w3bkjug" target="_blank">fresh-sun-24</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0769471ba97b49ceae2f4d0eedb7c60b", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "07feae3452c8491d99e1382fa969dc04", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "794c0bedb7a64166bc3d13103c5acfde", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (691 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6c9f3feee8de47c5bde30fe62e980d1a", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:3w3bkjug) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ef0d3b1807e74430af93d9beb9e1ce00", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">fresh-sun-24</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/3w3bkjug" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/3w3bkjug</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010633-3w3bkjug/logs</code></div><div class="output text_html">Successfully finished last run (ID:3w3bkjug). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1dda8eab523846d78b45e42d6ffb7137", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010700-3bpaphe7</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/3bpaphe7" target="_blank">rose-deluge-25</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "42988d4eae5247908ee96a52d1582a7b", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "976670d34f8148a3a0628b3ad0044a1c", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d6b69183cd0a4f8ebdd2654c519888ae", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "757755ef851d4c389041e49713927ae1", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "be643571d89447ef8ea31c221ad2fc41", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7faa0a9b92cd47708b530c8c60d8ae42", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "bb3404445f684607893adc861e82d5bc", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:3bpaphe7) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "bff6ff273516484a99283faeda197716", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▅▄▃▃▂▂▁▁▂▁▁▁</td></tr><tr><td>acc</td><td>▁▅▇██</td></tr><tr><td>eval_loss</td><td>█▄▁▁▁</td></tr><tr><td>global_step</td><td>▁▂▂▂▃▃▃▄▅▅▅▆▆▆▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▆▅▅▄▃▃▂▂▁</td></tr><tr><td>mcc</td><td>▁▅▇██</td></tr><tr><td>train_loss</td><td>█▄▃▄▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.37927</td></tr><tr><td>acc</td><td>0.77644</td></tr><tr><td>eval_loss</td><td>0.81464</td></tr><tr><td>global_step</td><td>650</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.74135</td></tr><tr><td>train_loss</td><td>0.37927</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">rose-deluge-25</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/3bpaphe7" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/3bpaphe7</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010700-3bpaphe7/logs</code></div><div class="output text_html">Successfully finished last run (ID:3bpaphe7). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0b1783190b994555bdda0673dbc5a1e2", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010846-1x0zsmyr</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1x0zsmyr" target="_blank">icy-firebrand-26</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "48cbec1a7bb94f86bb031f80c9e0bd7f", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6cd249d6c3434de393402df7d457c32a", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d4b8c631477c4ac29624dc81a507a89b", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (691 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3d7bb59402c2476baa7ebf7564a8230d", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1x0zsmyr) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "06e952f1fa9448f7b6e411162f182aa2", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">icy-firebrand-26</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1x0zsmyr" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/1x0zsmyr</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010846-1x0zsmyr/logs</code></div><div class="output text_html">Successfully finished last run (ID:1x0zsmyr). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "81654865bc9b463dbea0e87f43d7edfb", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010913-36o0ldih</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/36o0ldih" target="_blank">silvery-fire-27</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "360768ce145c4a17b7705667360d91e4", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c9e1842e21074183b76a5444c7d841b7", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "efee9658f55c4586af32a460f2c5b93d", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a91cd5632c184ee68443ca51591b77b7", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b9108e7e4ecf4548a313a5c8f2f33dae", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "69510f1076b84ae3b369cfccef9ecc1e", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dd28186b89cd4f568f785b8343c8d168", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:36o0ldih) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f6a1020f453842309c3d40f0ad7e9f21", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▆▄▅▄▂▃▂▂▂▁▁▁</td></tr><tr><td>acc</td><td>▁▅▇██</td></tr><tr><td>eval_loss</td><td>█▃▂▁▁</td></tr><tr><td>global_step</td><td>▁▂▂▂▃▃▃▄▅▅▅▆▆▆▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▆▅▅▄▃▃▂▂▁</td></tr><tr><td>mcc</td><td>▁▅▇██</td></tr><tr><td>train_loss</td><td>█▇▇▁▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.32564</td></tr><tr><td>acc</td><td>0.78852</td></tr><tr><td>eval_loss</td><td>0.77292</td></tr><tr><td>global_step</td><td>650</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.75403</td></tr><tr><td>train_loss</td><td>0.32564</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">silvery-fire-27</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/36o0ldih" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/36o0ldih</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_010913-36o0ldih/logs</code></div><div class="output text_html">Successfully finished last run (ID:36o0ldih). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e9db1cd49ddb4581b5269a7a63f1f2c9", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_011101-2zt1qpx2</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2zt1qpx2" target="_blank">fresh-butterfly-28</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9747dff1aa6a4297a524d6152e8b5fc3", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "945c227d78d64a858e663b3d564a68a0", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">records</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">create_records_from_cv_preds</span><span class="p">(</span>
    <span class="n">cv_preds</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TextClassificationRecord(text=&quot;노동부 관계자 는 &#39; 삼성전자서비스 는 대기업 이 교육 · 훈련 능력 이 없는 협력업체 직원 들 의 훈련 을 지원 하기 위한 사업 인 &#39; 대기업 중소기업 상생 형 컨소시엄 &#39; 으로 운영비 · 훈련 비 등을 지원 받았다 &#39; 며 &#39; 위장 도 급 은 원청 과 협력업체 의 관계 를 종합적 으로 판단 하는 것이며 훈련 사업 과는 관련 이 없다 &#39; 고 말 했다 .&quot;, inputs={&#39;text&#39;: &quot;노동부 관계자 는 &#39; 삼성전자서비스 는 대기업 이 교육 · 훈련 능력 이 없는 협력업체 직원 들 의 훈련 을 지원 하기 위한 사업 인 &#39; 대기업 중소기업 상생 형 컨소시엄 &#39; 으로 운영비 · 훈련 비 등을 지원 받았다 &#39; 며 &#39; 위장 도 급 은 원청 과 협력업체 의 관계 를 종합적 으로 판단 하는 것이며 훈련 사업 과는 관련 이 없다 &#39; 고 말 했다 .&quot;}, prediction=[(&#39;G-기업윤리/불공정/소송&#39;, 0.014792973524635432), (&#39;E-환경영향&#39;, 0.01011066196727523), (&#39;S-고용&#39;, 0.03259826738194377), (&#39;G-지배구조&#39;, 0.006677545399021065), (&#39;S-소비자&#39;, 0.017965496318325943), (&#39;E-환경혁신&#39;, 0.012528997457076856), (&#39;S-사회공헌&#39;, 0.07528742959158059), (&#39;S-재해/안전관리&#39;, 0.01563472938407527), (&#39;E-기후변화&#39;, 0.011562358220107061), (&#39;S-기업(공급망)동반성장/상생&#39;, 0.802841540755959)], prediction_agent=None, annotation=&#39;S-고용&#39;, annotation_agent=None, multi_label=False, explanation=None, id=None, metadata={&#39;id&#39;: 0, &#39;split&#39;: &#39;train&#39;}, status=&#39;Validated&#39;, event_timestamp=None, metrics=None, search_keywords=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get records with potential label errors</span>
<span class="n">records_with_label_error</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">find_label_errors</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records_with_label_error</span><span class="p">))</span>
<span class="n">records_with_label_error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>406
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TextClassificationRecord(text=&#39;효과적 적 응 을 위해 기존 환경정보 의 관리 · 활용 은 필수적 이다 .\n구체적 인 자료 없이 불확실성 이 높은 상황 에서의 정책 입안 은 위험성 이 높으며 불필요 한 거래비용 을 야기 하기 때문이 다 .\n최근 런 칭 된 환경 과학 및 연구 를 공유 하는 새로운 플랫폼 인 unep 라이브 ( unep live ) 는 대중 과 정책 입안자 들 에게 네트워크 , 클라우드 컴퓨팅 , 대용량 데이터 , 향상 된 검색 기능 을 통해 광범위 한 데이터 를 제공 한다 .\n사용자 들 은 애플리케이션 , 멀티미디어 및 디지털 출판 도구 를 통해 unep 의 정보 뿐만 아니라 국가 · 지역적 자원 과 그 외 지식 및 데이터 로 접근 이 가능 하다 .&#39;, inputs={&#39;text&#39;: &#39;효과적 적 응 을 위해 기존 환경정보 의 관리 · 활용 은 필수적 이다 .\n구체적 인 자료 없이 불확실성 이 높은 상황 에서의 정책 입안 은 위험성 이 높으며 불필요 한 거래비용 을 야기 하기 때문이 다 .\n최근 런 칭 된 환경 과학 및 연구 를 공유 하는 새로운 플랫폼 인 unep 라이브 ( unep live ) 는 대중 과 정책 입안자 들 에게 네트워크 , 클라우드 컴퓨팅 , 대용량 데이터 , 향상 된 검색 기능 을 통해 광범위 한 데이터 를 제공 한다 .\n사용자 들 은 애플리케이션 , 멀티미디어 및 디지털 출판 도구 를 통해 unep 의 정보 뿐만 아니라 국가 · 지역적 자원 과 그 외 지식 및 데이터 로 접근 이 가능 하다 .&#39;}, prediction=[(&#39;G-기업윤리/불공정/소송&#39;, 0.005687928438936715), (&#39;E-환경영향&#39;, 0.0018410125274279446), (&#39;S-고용&#39;, 0.0028207603159319233), (&#39;G-지배구조&#39;, 0.003179272280394612), (&#39;S-소비자&#39;, 0.9719110247106496), (&#39;E-환경혁신&#39;, 0.003998241574432772), (&#39;S-사회공헌&#39;, 0.0028065557235574324), (&#39;S-재해/안전관리&#39;, 0.001974979448829106), (&#39;E-기후변화&#39;, 0.0013657693473079205), (&#39;S-기업(공급망)동반성장/상생&#39;, 0.004414455632531461)], prediction_agent=None, annotation=&#39;E-기후변화&#39;, annotation_agent=None, multi_label=False, explanation=None, id=None, metadata={&#39;id&#39;: 30, &#39;split&#39;: &#39;train&#39;, &#39;label_error_candidate&#39;: 0}, status=&#39;Validated&#39;, event_timestamp=None, metrics=None, search_keywords=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove rows from cv_preds that have label errors</span>
<span class="n">cv_preds_new</span> <span class="o">=</span> <span class="n">cv_preds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records_with_label_error</span><span class="p">:</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">metadata</span>
    <span class="n">cv_preds_new</span> <span class="o">=</span> <span class="n">cv_preds_new</span><span class="p">[</span><span class="n">cv_preds_new</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cv_preds_new</span><span class="p">))</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_topic_data.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">cv_preds_new</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5796
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-cross-validated-esg-cv-topics-kr-dataset">
<h2>Build cross-validated <code class="docutils literal notranslate"><span class="pre">esg_cv_topics_kr</span></code> dataset<a class="headerlink" href="#build-cross-validated-esg-cv-topics-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_topic_data.parquet&quot;</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset=dataset_build&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_topics_kr&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">build</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">stratify_on</span> <span class="o">=</span> <span class="s2">&quot;labels&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">reset_index</span><span class="o">.</span><span class="n">drop_index</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">esg_valid_topic_ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">esg_valid_topic_ds</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function load_dataframe at 0x7f29d12260d0&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function reset_index at 0x7f29d1225310&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function split_sampling at 0x7f29d1221ee0&gt;)
INFO:ekorpkit.base:Using batcher with minibatch size: 17
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1c6e1474e7f04b24972880c725154ed6", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 5
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "732bad68809447c9944373243376d90f", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 6
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b81a638a8a5349a2adc6335b701e79b0", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="train-and-evaluate-esg-cv-topics-kr-dataset">
<h2>Train and evaluate <code class="docutils literal notranslate"><span class="pre">esg_cv_topics_kr</span></code> dataset<a class="headerlink" href="#train-and-evaluate-esg-cv-topics-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_topics_kr&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>

<span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=ekonelectra-base&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s1">&#39;model/transformer=classification&#39;</span><span class="p">,</span> <span class="n">overrides</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_topics&quot;</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_method_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">]</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="o">.</span><span class="n">include_values</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="o">.</span><span class="n">include_percentages</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Calling train
Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e165f546009c4cc08d63652222cc8c0d", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (691 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d54bb530c370430a9d316b45d26318b9", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:2zt1qpx2) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "10f7a294434d43d99809f42d4292092b", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">fresh-butterfly-28</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2zt1qpx2" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_topics/runs/2zt1qpx2</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_topics/ekonelectra-base/wandb/run-20220920_011101-2zt1qpx2/logs</code></div><div class="output text_html">Successfully finished last run (ID:2zt1qpx2). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b5bc85d7273e4916b2c3952875ad3948", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_topics/ekonelectra-base/wandb/run-20220920_021330-7m7e05hu</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics/runs/7m7e05hu" target="_blank">laced-vortex-1</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5749d207bc5e49beb84155b6319af6d3", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "97a720d4164d438a98e9fcd5eb14afb8", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "751d2f94be5c446f9190eb128c4abbc9", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "14037f4f0e064905b041aa547a1808a1", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d7ae4300ee9c4a558ba75c6889a1e72b", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "103afe4c63a7410fb720c27bb48f4865", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cdcc707c75b9414b8dcb20027533008c", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:7m7e05hu) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e41b0a5d969f435688ce08c8257f1089", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▄▅▃▄▃▄▂▁▁▁▁</td></tr><tr><td>acc</td><td>▁▅▆▇█</td></tr><tr><td>eval_loss</td><td>█▃▂▁▁</td></tr><tr><td>global_step</td><td>▁▂▂▂▃▃▃▄▅▅▅▆▆▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▅▅▄▄▃▂▂▁</td></tr><tr><td>mcc</td><td>▁▅▆▇█</td></tr><tr><td>train_loss</td><td>█▄▄▂▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.13852</td></tr><tr><td>acc</td><td>0.82866</td></tr><tr><td>eval_loss</td><td>0.71346</td></tr><tr><td>global_step</td><td>610</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.80069</td></tr><tr><td>train_loss</td><td>0.12119</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">laced-vortex-1</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics/runs/7m7e05hu" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics/runs/7m7e05hu</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_topics/ekonelectra-base/wandb/run-20220920_021330-7m7e05hu/logs</code></div><div class="output text_html">Successfully finished last run (ID:7m7e05hu). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "98f620467320433fb4b7abf17eb16bf7", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_topics/ekonelectra-base/wandb/run-20220920_021512-3upm5zwe</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics/runs/3upm5zwe" target="_blank">super-field-2</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Calling eval
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a3ca5ce890fa48d6b4110fbe75ca0bd2", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (712 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8cfcd5af90734124867d048170af9be2", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.8456896551724138
Precison:  0.8492333903150788
Recall:  0.8456896551724138
F1 Score:  0.8465215619765862
Model Report: 
___________________________________________________
                  precision    recall  f1-score   support

          E-기후변화       0.89      0.83      0.86        47
          E-환경영향       0.84      0.79      0.82        62
          E-환경혁신       0.75      0.80      0.77        51
   G-기업윤리/불공정/소송       0.77      0.76      0.76       134
          G-지배구조       0.84      0.87      0.85       167
            S-고용       0.87      0.89      0.88       198
S-기업(공급망)동반성장/상생       0.68      0.84      0.75        49
          S-사회공헌       0.87      0.88      0.87       117
           S-소비자       0.93      0.85      0.89       286
       S-재해/안전관리       0.78      0.82      0.80        49

        accuracy                           0.85      1160
       macro avg       0.82      0.83      0.83      1160
    weighted avg       0.85      0.85      0.85      1160
</pre></div>
</div>
<img alt="../../../_images/rubrix_classifiers_26_37.png" src="../../../_images/rubrix_classifiers_26_37.png" />
</div>
</div>
</section>
<section id="prepare-esg-polarity-kr-dataset">
<h2>Prepare <code class="docutils literal notranslate"><span class="pre">esg_polarity_kr</span></code> dataset<a class="headerlink" href="#prepare-esg-polarity-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;esg_polarity_kr&#39;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">]</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">ds_cfg</span><span class="p">)</span>
<span class="n">existing_polarity_data</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">existing_polarity_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_polarity_existing.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">existing_polarity_data</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(13616, 2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-a-valid-polarity-dataset">
<h2>Build a valid polarity dataset<a class="headerlink" href="#build-a-valid-polarity-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overrides</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;+model/transformer=classification&quot;</span><span class="p">,</span>
    <span class="s2">&quot;+model/transformer/pretrained=ekonelectra-base&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;model/transformer=classification&quot;</span><span class="p">,</span> <span class="n">overrides</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_invalid&quot;</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_method_</span> <span class="o">=</span> <span class="p">[]</span>


<span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_group</span><span class="o">=</span><span class="s2">&quot;pipeline&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_polarity_valid&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">_pipeline_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;predict&quot;</span><span class="p">]</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_cfg</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-preds.parquet&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">polarity_valid_preds_df</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">polarity_valid_preds_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function predict at 0x7f29d12254c0&gt;)
INFO:ekorpkit.base:No method defined to call
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "70d78e82afdf4e1b8e7e082e6513cc6a", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (668 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "57a34499955f46bd9809afbd0d87186e", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>labels</th>
      <th>pred_labels</th>
      <th>raw_preds</th>
      <th>pred_probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>헌법재판소는 먼저 고발권 행사의 재량성에 대해서는 공정거래법은 제71조에서 '......</td>
      <td>Negative</td>
      <td>Validated</td>
      <td>{'Discarded': 0.34311446903531895, 'Validated'...</td>
      <td>0.656886</td>
    </tr>
    <tr>
      <th>1</th>
      <td>특히, 그룹내 업종도 다르고 재무구조도 다른 계열사들이 그룹으로 묶여지는 특수한 지...</td>
      <td>Neutral</td>
      <td>Validated</td>
      <td>{'Discarded': 0.4446329014792689, 'Validated':...</td>
      <td>0.555367</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018년 신규 취업자수는 36만명 증가하고, 전체 취업자 증가율은 1.4%로 20...</td>
      <td>Neutral</td>
      <td>Discarded</td>
      <td>{'Discarded': 0.6374659019661213, 'Validated':...</td>
      <td>0.637466</td>
    </tr>
    <tr>
      <th>3</th>
      <td>앞서 분석한 대로 5월엔 펀더멘털 개선과 위험 요인들이 h지수의 방향을 좌우할 것이...</td>
      <td>Neutral</td>
      <td>Discarded</td>
      <td>{'Discarded': 0.6180178427067431, 'Validated':...</td>
      <td>0.618018</td>
    </tr>
    <tr>
      <th>4</th>
      <td>재생에너지의 성장 속도는 향후 10년 안에 세계 주요 지역의 전통 에너지원 (con...</td>
      <td>Positive</td>
      <td>Validated</td>
      <td>{'Discarded': 0.4631067621441408, 'Validated':...</td>
      <td>0.536893</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valid_existing_topic_data</span> <span class="o">=</span> <span class="n">polarity_valid_preds_df</span><span class="p">[</span>
    <span class="n">polarity_valid_preds_df</span><span class="o">.</span><span class="n">pred_labels</span> <span class="o">==</span> <span class="s2">&quot;Validated&quot;</span>
<span class="p">][</span><span class="n">cols</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">valid_existing_topic_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_polarity_data.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">valid_existing_topic_data</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9086, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset=dataset_build&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_polarity_kr&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">build</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">stratify_on</span> <span class="o">=</span> <span class="s2">&quot;labels&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">reset_index</span><span class="o">.</span><span class="n">drop_index</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">esg_valid_topic_ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">esg_valid_topic_ds</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function load_dataframe at 0x7f29d12260d0&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function reset_index at 0x7f29d1225310&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function split_sampling at 0x7f29d1221ee0&gt;)
INFO:ekorpkit.base:Using batcher with minibatch size: 26
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ff515869111f49b09d258977e9181331", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 7
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b8ca0d59ad1548a182d86d4d65f611ae", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 8
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ed2e6f0425d240c698b8b6bca8fd1063", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="cross-validate-esg-polarity-kr-dataset">
<h2>Cross-validate <code class="docutils literal notranslate"><span class="pre">esg_polarity_kr</span></code> dataset<a class="headerlink" href="#cross-validate-esg-polarity-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_polarity_kr&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>

<span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=ekonelectra-base&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s1">&#39;model/transformer=classification&#39;</span><span class="p">,</span> <span class="n">overrides</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_valid_polarity&quot;</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_method_</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>

<span class="n">cv_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cross_val_predict</span><span class="p">(</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">cv_preds</span> <span class="o">=</span> <span class="n">cv_preds</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">})</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">cv_preds</span><span class="p">,</span> <span class="s2">&quot;esg_valid_polarity_cv.parquet&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:No method defined to call
Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4b5cb517372b45608edf65ba48074271", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (668 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8d07c54683824aaea522968e6653ea36", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:3upm5zwe) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "39efeb95250d487fb73f3ea38277a0e0", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">super-field-2</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics/runs/3upm5zwe" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_topics/runs/3upm5zwe</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_topics/ekonelectra-base/wandb/run-20220920_021512-3upm5zwe/logs</code></div><div class="output text_html">Successfully finished last run (ID:3upm5zwe). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4a897c4379fa463db595a71b4c60a43e", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022059-1s5a57gq</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1s5a57gq" target="_blank">feasible-shadow-7</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0ee4cd8727ca4cce8bca55b48fcd3543", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3ea01de1750142d5b6ee5717f776c342", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "26a15258d76f4c339d47853648ea0b7a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "934b1d11900c46b98ed7b29eae0cfe2c", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "bead0624935844efb442fe8064c2f72f", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1s5a57gq) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e7beb25124344adc8df66d3269a6e0c8", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▄▆▆▅▄▄▅▆▁</td></tr><tr><td>acc</td><td>▁▅█</td></tr><tr><td>eval_loss</td><td>▄▁█</td></tr><tr><td>global_step</td><td>▁▂▂▃▃▄▅▅▅▆▇▇█</td></tr><tr><td>lr</td><td>█▇▆▆▅▄▃▃▂▁</td></tr><tr><td>mcc</td><td>█▁▃</td></tr><tr><td>train_loss</td><td>▅█▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.19466</td></tr><tr><td>acc</td><td>0.68913</td></tr><tr><td>eval_loss</td><td>0.7345</td></tr><tr><td>global_step</td><td>549</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.44182</td></tr><tr><td>train_loss</td><td>0.22353</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">feasible-shadow-7</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1s5a57gq" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1s5a57gq</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022059-1s5a57gq/logs</code></div><div class="output text_html">Successfully finished last run (ID:1s5a57gq). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "27f6cc264ccb43b58387920524208448", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022233-3jgaq9xx</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/3jgaq9xx" target="_blank">gentle-wildflower-8</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "11a2f006a83e4756ba3a07f3ac466d02", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "263822d3fba24a5483beabad52eb9094", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3ca5a83b2e6440e1bf4cf05737fcb9b8", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (668 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d8f2a2965ec34188907d5385f011d5cb", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:3jgaq9xx) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e407edff8e7f46098a267aa23e57361d", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">gentle-wildflower-8</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/3jgaq9xx" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/3jgaq9xx</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022233-3jgaq9xx/logs</code></div><div class="output text_html">Successfully finished last run (ID:3jgaq9xx). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1e870bc8e980441797472854392f4f62", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022302-1ym4z9wq</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1ym4z9wq" target="_blank">comfy-haze-9</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d4910871acca430cb8e997c2b70f1b9a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d5e3bcb5be924aab968aeeceb36a0ddf", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b7342cefbf0c49b2adcbcbc5a99c23c2", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "034fff9415a248d2b089daad9886a59f", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7f5cff49cac345ea922ed49e97e05f1f", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1ym4z9wq) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9e24d09fe28b41da9a0048c58dd6a2ef", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>██▆▅▅▄▄▃▁▃</td></tr><tr><td>acc</td><td>▁█▅</td></tr><tr><td>eval_loss</td><td>█▁▆</td></tr><tr><td>global_step</td><td>▁▂▂▃▃▄▅▅▅▆▇▇█</td></tr><tr><td>lr</td><td>█▇▆▆▅▄▃▃▂▁</td></tr><tr><td>mcc</td><td>▁▇█</td></tr><tr><td>train_loss</td><td>█▅▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.4331</td></tr><tr><td>acc</td><td>0.69807</td></tr><tr><td>eval_loss</td><td>0.68063</td></tr><tr><td>global_step</td><td>549</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.47998</td></tr><tr><td>train_loss</td><td>0.25664</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">comfy-haze-9</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1ym4z9wq" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1ym4z9wq</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022302-1ym4z9wq/logs</code></div><div class="output text_html">Successfully finished last run (ID:1ym4z9wq). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e79f6c1a949342fab7767adee6007910", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022431-1m0b7bee</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1m0b7bee" target="_blank">lyric-voice-10</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f880d0e76bf0437c96b4b17c52439f1a", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (670 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f729a8d53c724b17b95e960bfa3c9737", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a12871463715497f85824d28c11548d6", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (670 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "052460a6f8204bc7bfcf56f7549324c6", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1m0b7bee) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3a2c19aec18a498fbb2b9d78ca3f60a9", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">lyric-voice-10</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1m0b7bee" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1m0b7bee</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022431-1m0b7bee/logs</code></div><div class="output text_html">Successfully finished last run (ID:1m0b7bee). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3f6be72fa6a84579910843139e9e2301", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022500-rbs043xj</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/rbs043xj" target="_blank">smooth-lake-11</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "ef6888fbfa1041478849dd3bb4ce49b4", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "49f41444d0b2480fb3cf91def8fce53f", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4e55a262c60147bf9c03258936190b17", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "386d4da6733e410a9f4af27ddffc578a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4a9237007b484b40a752afc2050948a8", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:rbs043xj) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "fe8af3341e3d4345a7e1bdd9f12e9d20", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>▇▇█▂▁▄▃▁▂▃</td></tr><tr><td>acc</td><td>▁▇█</td></tr><tr><td>eval_loss</td><td>▇▁█</td></tr><tr><td>global_step</td><td>▁▂▂▃▃▄▅▅▅▆▇▇█</td></tr><tr><td>lr</td><td>█▇▆▆▅▄▃▃▂▁</td></tr><tr><td>mcc</td><td>▁▆█</td></tr><tr><td>train_loss</td><td>█▂▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.51426</td></tr><tr><td>acc</td><td>0.70495</td></tr><tr><td>eval_loss</td><td>0.67766</td></tr><tr><td>global_step</td><td>549</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.46167</td></tr><tr><td>train_loss</td><td>0.19584</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">smooth-lake-11</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/rbs043xj" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/rbs043xj</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022500-rbs043xj/logs</code></div><div class="output text_html">Successfully finished last run (ID:rbs043xj). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "322b93da817e4542bc6b012b070bc453", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022632-3aj4gdmk</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/3aj4gdmk" target="_blank">vocal-night-12</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "213a83b224b54425a16829deb31004a0", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e05c8ec4dc38461994607a36254876d7", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "d327629f171448d28c52eedd7e4d2597", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (670 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9650fe6c95e04f89a49a86081da3a80c", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:3aj4gdmk) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "aed2a2a1fa244c77b7fc848e7366f230", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">vocal-night-12</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/3aj4gdmk" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/3aj4gdmk</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022632-3aj4gdmk/logs</code></div><div class="output text_html">Successfully finished last run (ID:3aj4gdmk). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "044d38145bc2405998e748efcedbba02", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022703-1f354j2g</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1f354j2g" target="_blank">faithful-sunset-13</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "43f3919d203a4183aca423c2adf3cde7", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "db93fd6357544a36a0811aac1dfe1763", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a609196078f7447faf36a2e4367d0b8a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "79137e07c7644a4f992007998d0f70a5", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f859151249af4cec83d5abab03811e48", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1f354j2g) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "9ab3faaf74b24c2092e0c2aa44d6e1c6", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▇▅▅▄▃▄▁▁▃</td></tr><tr><td>acc</td><td>▁█▂</td></tr><tr><td>eval_loss</td><td>▄▁█</td></tr><tr><td>global_step</td><td>▁▂▂▃▃▄▅▅▅▆▇▇█</td></tr><tr><td>lr</td><td>█▇▆▆▅▄▃▃▂▁</td></tr><tr><td>mcc</td><td>▁█▁</td></tr><tr><td>train_loss</td><td>█▆▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.44572</td></tr><tr><td>acc</td><td>0.69395</td></tr><tr><td>eval_loss</td><td>0.70146</td></tr><tr><td>global_step</td><td>546</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.46163</td></tr><tr><td>train_loss</td><td>0.36392</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">faithful-sunset-13</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1f354j2g" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1f354j2g</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022703-1f354j2g/logs</code></div><div class="output text_html">Successfully finished last run (ID:1f354j2g). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e474504cc5cc4b2db8b3ebd355c8d8a6", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022833-2yq3mw4j</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/2yq3mw4j" target="_blank">clear-dragon-14</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "945aa50a714544e6a464f6a24825251c", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5aa5952cd2f942d7af09d8e543c98008", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "94e0cbf3222c4775ac46f49d4edb32b3", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (670 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1f39cbc9df8647beb2e139dc50b5a575", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:2yq3mw4j) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "95bcdc102bd04af09cebb24f19a01ad9", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">clear-dragon-14</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/2yq3mw4j" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/2yq3mw4j</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022833-2yq3mw4j/logs</code></div><div class="output text_html">Successfully finished last run (ID:2yq3mw4j). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "da4bf1009756468cb5493e45f1d9274d", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022901-2a59bqsm</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/2a59bqsm" target="_blank">eager-shadow-15</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "3f348228d23b4719a2b45f2c94e8fa66", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "4b353ba5879f4166a549facda0ec014a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "da7cfdfebb3b496a9df4d62b91e8c101", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dd365a0935654a5baae32d7154a4514e", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a539019685904ffcbb4c66412ce86331", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:2a59bqsm) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "04dd5b9714a440779230a4a79e65c7f9", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▇▅▆▆▄▄▂▂▁</td></tr><tr><td>acc</td><td>▁█▆</td></tr><tr><td>eval_loss</td><td>▁▁█</td></tr><tr><td>global_step</td><td>▁▂▂▃▃▄▅▅▅▆▇▇█</td></tr><tr><td>lr</td><td>█▇▆▆▅▄▃▃▂▁</td></tr><tr><td>mcc</td><td>▁██</td></tr><tr><td>train_loss</td><td>▅█▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.20041</td></tr><tr><td>acc</td><td>0.69876</td></tr><tr><td>eval_loss</td><td>0.72059</td></tr><tr><td>global_step</td><td>549</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.47249</td></tr><tr><td>train_loss</td><td>0.10802</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">eager-shadow-15</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/2a59bqsm" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/2a59bqsm</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_022901-2a59bqsm/logs</code></div><div class="output text_html">Successfully finished last run (ID:2a59bqsm). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cb85b0b7add04507a020ff5b706bde73", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_023029-1yqr3hin</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1yqr3hin" target="_blank">earnest-lake-16</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1d213648b4b0494dbe55839e8c1271b0", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e9230a6e2d6641899ecb955962191a38", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">records</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">create_records_from_cv_preds</span><span class="p">(</span>
    <span class="n">cv_preds</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># get records with potential label errors</span>
<span class="n">records_with_label_error</span> <span class="o">=</span> <span class="n">rb</span><span class="o">.</span><span class="n">find_label_errors</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">records_with_label_error</span><span class="p">))</span>
<span class="n">records_with_label_error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1251
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TextClassificationRecord(text=&#39;더 느린 속도의 공 격자가 양심적인 체인을 따라잡을 가능성은 후속 블록이 추가될 때마다 지수함수적으로 감소한다는 점을 뒤에서 입증하기로 한다\n가속하는 하드웨어 스피트와 장기적으로 변동하는 이익에 대응하기 위해 작업 증명 산출의 난이도는 1시간마다 블록 수를 이정한 평균치를 유지하는 것을 목표로 하는 평균 이동에 의해 결정된다\n블록 산출 속도가 빠를수록 난이도가 증가한다\n네트워크(network)나카 모토가 생각한 네트워크 실행 순서는 다음과 같다 23) 새로운 거래는 전체 노드들에게 송신된다\n각 노드가 새로운 거래를 블록에 반영한다&#39;, inputs={&#39;text&#39;: &#39;더 느린 속도의 공 격자가 양심적인 체인을 따라잡을 가능성은 후속 블록이 추가될 때마다 지수함수적으로 감소한다는 점을 뒤에서 입증하기로 한다\n가속하는 하드웨어 스피트와 장기적으로 변동하는 이익에 대응하기 위해 작업 증명 산출의 난이도는 1시간마다 블록 수를 이정한 평균치를 유지하는 것을 목표로 하는 평균 이동에 의해 결정된다\n블록 산출 속도가 빠를수록 난이도가 증가한다\n네트워크(network)나카 모토가 생각한 네트워크 실행 순서는 다음과 같다 23) 새로운 거래는 전체 노드들에게 송신된다\n각 노드가 새로운 거래를 블록에 반영한다&#39;}, prediction=[(&#39;Positive&#39;, 0.02792251281400827), (&#39;Neutral&#39;, 0.9533914708501714), (&#39;Negative&#39;, 0.018686016335820517)], prediction_agent=None, annotation=&#39;Positive&#39;, annotation_agent=None, multi_label=False, explanation=None, id=None, metadata={&#39;id&#39;: 1041, &#39;split&#39;: &#39;train&#39;, &#39;label_error_candidate&#39;: 0}, status=&#39;Validated&#39;, event_timestamp=None, metrics=None, search_keywords=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove rows from cv_preds that have label errors</span>
<span class="n">cv_preds_new</span> <span class="o">=</span> <span class="n">cv_preds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records_with_label_error</span><span class="p">:</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">metadata</span>
    <span class="n">cv_preds_new</span> <span class="o">=</span> <span class="n">cv_preds_new</span><span class="p">[</span><span class="n">cv_preds_new</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cv_preds_new</span><span class="p">))</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_polarity_data.parquet&quot;</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">cv_preds_new</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7835
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-cross-validated-esg-cv-polarity-kr-dataset">
<h2>Build cross-validated <code class="docutils literal notranslate"><span class="pre">esg_cv_polarity_kr</span></code> dataset<a class="headerlink" href="#build-cross-validated-esg-cv-polarity-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_polarity_data.parquet&quot;</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset=dataset_build&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_polarity_kr&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">build</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">stratify_on</span> <span class="o">=</span> <span class="s2">&quot;labels&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">split_sampling</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="n">reset_index</span><span class="o">.</span><span class="n">drop_index</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">esg_cv_polarity_ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">esg_cv_polarity_ds</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function load_dataframe at 0x7f29d12260d0&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function reset_index at 0x7f29d1225310&gt;)
INFO:ekorpkit.base:Applying pipe: functools.partial(&lt;function split_sampling at 0x7f29d1221ee0&gt;)
INFO:ekorpkit.base:Using batcher with minibatch size: 22
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a7e8f96577d94def854bdbba1778d948", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 6
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b45a94aaba8d4c4c94ec30dc8598c022", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Using batcher with minibatch size: 7
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7c49a40ec5e0494292feb35a267b5079", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</section>
<section id="train-and-evaluate-esg-cv-polarity-kr-dataset">
<h2>Train and evaluate <code class="docutils literal notranslate"><span class="pre">esg_cv_polarity_kr</span></code> dataset<a class="headerlink" href="#train-and-evaluate-esg-cv-polarity-kr-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_polarity_kr&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>

<span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=ekonelectra-base&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="s1">&#39;model/transformer=classification&#39;</span><span class="p">,</span> <span class="n">overrides</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;esg_cv_polarity&quot;</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_method_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">]</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span><span class="s1">&#39;neutral&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Calling train
Some weights of the model checkpoint at entelecheia/ekonelectra-base-discriminator were not used when initializing ElectraForSequenceClassification: [&#39;discriminator_predictions.dense.bias&#39;, &#39;discriminator_predictions.dense.weight&#39;, &#39;discriminator_predictions.dense_prediction.weight&#39;, &#39;discriminator_predictions.dense_prediction.bias&#39;]
- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at entelecheia/ekonelectra-base-discriminator and are newly initialized: [&#39;classifier.dense.weight&#39;, &#39;classifier.dense.bias&#39;, &#39;classifier.out_proj.bias&#39;, &#39;classifier.out_proj.weight&#39;]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "31655a378c6c4c5bacf63c967995b095", "version_major": 2, "version_minor": 0}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Token indices sequence length is longer than the specified maximum sequence length for this model (670 &gt; 512). Running this sequence through the model will result in indexing errors
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0d901e1b361c43048df9f8c9c44b7340", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1yqr3hin) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "129e4097062c4f90a45bb60501b21761", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">earnest-lake-16</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1yqr3hin" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_valid_polarity/runs/1yqr3hin</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_valid_polarity/ekonelectra-base/wandb/run-20220920_023029-1yqr3hin/logs</code></div><div class="output text_html">Successfully finished last run (ID:1yqr3hin). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7f3c8b6042b54ab6ade536cbd347092f", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_polarity/ekonelectra-base/wandb/run-20220920_024031-1trwr7nn</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_polarity/runs/1trwr7nn" target="_blank">driven-glitter-1</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6e7019e745284cd387247d271cdad919", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "bb3095b4ab1f4a9e94e646b1bae963d4", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "73615459c3dd4e718127abfa923a925a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5b254eb53b1045daa51ee0a87a3390b2", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "58399e4c9bde4e51b88ad32a5b6c2455", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8c2b0fe27f1b4817a4af9239df600cce", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "04569c81574e4661b361053af8465a1b", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1trwr7nn) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c05e16bedbc14fa68722f3bac551a602", "version_major": 2, "version_minor": 0}
</script><div class="output text_html"><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>█▇▆▃▅▃▄▆▆▁▂▁▁▁▁</td></tr><tr><td>acc</td><td>▄▁█▅▆</td></tr><tr><td>eval_loss</td><td>▁▃▂▇█</td></tr><tr><td>global_step</td><td>▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██</td></tr><tr><td>lr</td><td>█▇▇▆▆▆▅▄▄▃▃▂▂▂▁</td></tr><tr><td>mcc</td><td>▁▂█▅▆</td></tr><tr><td>train_loss</td><td>█▃▂▁▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>Training loss</td><td>0.00741</td></tr><tr><td>acc</td><td>0.79745</td></tr><tr><td>eval_loss</td><td>0.87184</td></tr><tr><td>global_step</td><td>790</td></tr><tr><td>lr</td><td>0.0</td></tr><tr><td>mcc</td><td>0.64711</td></tr><tr><td>train_loss</td><td>0.00613</td></tr></table><br/></div></div></div><div class="output text_html">Synced <strong style="color:#cdcd00">driven-glitter-1</strong>: <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_polarity/runs/1trwr7nn" target="_blank">https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_polarity/runs/1trwr7nn</a><br/>Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_polarity/ekonelectra-base/wandb/run-20220920_024031-1trwr7nn/logs</code></div><div class="output text_html">Successfully finished last run (ID:1trwr7nn). Initializing new run:<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8ca40c528d334acf954a7ce47bc2ba5f", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Tracking run with wandb version 0.13.3</div><div class="output text_html">Run data is saved locally in <code>/workspace/projects/ekorpkit-book/outputs/esg_cv_polarity/ekonelectra-base/wandb/run-20220920_024240-3b106lwn</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_polarity/runs/3b106lwn" target="_blank">denim-cosmos-2</a></strong> to <a href="https://wandb.ai/entelecheia/ekorpkit-book-esg_cv_polarity" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:ekorpkit.base:Calling eval
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "acb7a12c0d28404d8f863f0f082020b2", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cf9bcc77d02f401a9be544ebf7110ab6", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.7906828334396937
Precison:  0.7923396890705874
Recall:  0.7906828334396937
F1 Score:  0.7892586641434904
Model Report: 
___________________________________________________
              precision    recall  f1-score   support

    Negative       0.74      0.57      0.64       175
     Neutral       0.84      0.81      0.82       908
    Positive       0.73      0.83      0.78       484

    accuracy                           0.79      1567
   macro avg       0.77      0.74      0.75      1567
weighted avg       0.79      0.79      0.79      1567
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ekorpkit.models.transformer.simple.SimpleClassification at 0x7f28e2df51f0&gt;
</pre></div>
</div>
<img alt="../../../_images/rubrix_classifiers_40_37.png" src="../../../_images/rubrix_classifiers_40_37.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs/usecases/esg"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="predict_news.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Predicting ESG Categories and Polarities</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="predict_for_learning.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Preparing active learning data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Young Joon Lee<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>